const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/Home-DXQ5n2Xp.js","assets/js/vendor-CA6pEULs.js","assets/js/ResumeForm-91567FTo.js","assets/js/jspdf.es.min-BeUNq02D.js","assets/js/ui-CVXBtoA3.js","assets/js/router-CEJF1XdO.js","assets/css/Home-BfC0goYb.css","assets/js/ResumeForFreshers-CvEcBkLu.js","assets/js/ResumeForGulfJobs-Cp4D9i1q.js","assets/js/CoverLetterForTeachers-DOexCrws.js","assets/js/SignIn-CNdVNshW.js","assets/js/SignUp-C5Udgs6L.js","assets/js/ForgotPassword-DLI535bp.js"])))=>i.map(i=>d[i]);
var e,t,s=Object.defineProperty,r=Object.defineProperties,n=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c=(e,t)=>{for(var s in t||(t={}))o.call(t,s)&&l(e,s,t[s]);if(i)for(var s of i(t))a.call(t,s)&&l(e,s,t[s]);return e},d=(e,t)=>r(e,n(t)),u=(e,t)=>{var s={};for(var r in e)o.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&i)for(var r of i(e))t.indexOf(r)<0&&a.call(e,r)&&(s[r]=e[r]);return s},h=(e,t,s)=>l(e,"symbol"!=typeof t?t+"":t,s),f=(e,t,s)=>new Promise((r,n)=>{var i=e=>{try{a(s.next(e))}catch(t){n(t)}},o=e=>{try{a(s.throw(e))}catch(t){n(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(i,o);a((s=s.apply(e,t)).next())});import{r as m,b as p,g,a as y,c as b,d as v}from"./vendor-CA6pEULs.js";import{u as x,L as w,N as _,a as j,B as k,R as N,b as S}from"./router-CEJF1XdO.js";import{S as T,B as E,D as O,T as C,a as A,U as P,X as I,C as $,M as R,P as L,b as D,c as U,d as M,L as z,e as B,E as q,f as F,g as H,Z as J,h as W,i as K,A as V,j as G,k as Y,l as Q,m as X,n as Z,o as ee,p as te,q as se,r as re,F as ne,G as ie,s as oe,t as ae,u as le,W as ce,v as de,w as ue}from"./ui-CVXBtoA3.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var he={exports:{}},fe={},me=m,pe=Symbol.for("react.element"),ge=Symbol.for("react.fragment"),ye=Object.prototype.hasOwnProperty,be=me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ve={key:!0,ref:!0,__self:!0,__source:!0};function xe(e,t,s){var r,n={},i=null,o=null;for(r in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(o=t.ref),t)ye.call(t,r)&&!ve.hasOwnProperty(r)&&(n[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===n[r]&&(n[r]=t[r]);return{$$typeof:pe,type:e,key:i,ref:o,props:n,_owner:be.current}}fe.Fragment=ge,fe.jsx=xe,fe.jsxs=xe,he.exports=fe;var we=he.exports,_e={},je=p;_e.createRoot=je.createRoot,_e.hydrateRoot=je.hydrateRoot;const ke={},Ne=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in ke)return;ke[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script"),n.crossOrigin="",n.href=e,s&&n.setAttribute("nonce",s),document.head.appendChild(n),t?new Promise((t,s)=>{n.addEventListener("load",t),n.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function n(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&n(e.reason);return e().catch(n)})};var Se="undefined"!=typeof Element,Te="function"==typeof Map,Ee="function"==typeof Set,Oe="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function Ce(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;var s,r,n,i;if(Array.isArray(e)){if((s=e.length)!=t.length)return!1;for(r=s;0!==r--;)if(!Ce(e[r],t[r]))return!1;return!0}if(Te&&e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;for(i=e.entries();!(r=i.next()).done;)if(!Ce(r.value[1],t.get(r.value[0])))return!1;return!0}if(Ee&&e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i=e.entries();!(r=i.next()).done;)if(!t.has(r.value[0]))return!1;return!0}if(Oe&&ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if((s=e.length)!=t.length)return!1;for(r=s;0!==r--;)if(e[r]!==t[r])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf&&"function"==typeof e.valueOf&&"function"==typeof t.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString&&"function"==typeof e.toString&&"function"==typeof t.toString)return e.toString()===t.toString();if((s=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=s;0!==r--;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;if(Se&&e instanceof Element)return!1;for(r=s;0!==r--;)if(("_owner"!==n[r]&&"__v"!==n[r]&&"__o"!==n[r]||!e.$$typeof)&&!Ce(e[n[r]],t[n[r]]))return!1;return!0}return e!=e&&t!=t}const Ae=g(function(e,t){try{return Ce(e,t)}catch(s){if((s.message||"").match(/stack|recursion/i))return!1;throw s}});const Pe=g(function(e,t,s,r,n,i,o,a){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[s,r,n,i,o,a],d=0;(l=new Error(t.replace(/%s/g,function(){return c[d++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}});const Ie=g(function(e,t,s,r){var n=s?s.call(r,e,t):void 0;if(void 0!==n)return!!n;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),l=0;l<i.length;l++){var c=i[l];if(!a(c))return!1;var d=e[c],u=t[c];if(!1===(n=s?s.call(r,d,u,c):void 0)||void 0===n&&d!==u)return!1}return!0});var $e=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))($e||{}),Re={rel:["amphtml","canonical","alternate"]},Le={type:["application/ld+json"]},De={charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},Ue=Object.values($e),Me={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},ze=Object.entries(Me).reduce((e,[t,s])=>(e[s]=t,e),{}),Be="data-rh",qe="defaultTitle",Fe="defer",He="encodeSpecialCharacters",Je="onChangeClientState",We="titleTemplate",Ke="prioritizeSeoTags",Ve=(e,t)=>{for(let s=e.length-1;s>=0;s-=1){const r=e[s];if(Object.prototype.hasOwnProperty.call(r,t))return r[t]}return null},Ge=e=>{let t=Ve(e,"title");const s=Ve(e,We);if(Array.isArray(t)&&(t=t.join("")),s&&t)return s.replace(/%s/g,()=>t);const r=Ve(e,qe);return t||r||void 0},Ye=e=>Ve(e,Je)||(()=>{}),Qe=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>c(c({},e),t),{}),Xe=(e,t)=>t.filter(e=>void 0!==e.base).map(e=>e.base).reverse().reduce((t,s)=>{if(!t.length){const r=Object.keys(s);for(let n=0;n<r.length;n+=1){const i=r[n].toLowerCase();if(-1!==e.indexOf(i)&&s[i])return t.concat(s)}}return t},[]),Ze=(e,t,s)=>{const r={};return s.filter(t=>!!Array.isArray(t[e])||(void 0!==t[e]&&(t[e],console&&console.warn),!1)).map(t=>t[e]).reverse().reduce((e,s)=>{const n={};s.filter(e=>{let s;const i=Object.keys(e);for(let r=0;r<i.length;r+=1){const n=i[r],o=n.toLowerCase();-1===t.indexOf(o)||"rel"===s&&"canonical"===e[s].toLowerCase()||"rel"===o&&"stylesheet"===e[o].toLowerCase()||(s=o),-1===t.indexOf(n)||"innerHTML"!==n&&"cssText"!==n&&"itemprop"!==n||(s=n)}if(!s||!e[s])return!1;const o=e[s].toLowerCase();return r[s]||(r[s]={}),n[s]||(n[s]={}),!r[s][o]&&(n[s][o]=!0,!0)}).reverse().forEach(t=>e.push(t));const i=Object.keys(n);for(let t=0;t<i.length;t+=1){const e=i[t],s=c(c({},r[e]),n[e]);r[e]=s}return e},[]).reverse()},et=(e,t)=>{if(Array.isArray(e)&&e.length)for(let s=0;s<e.length;s+=1){if(e[s][t])return!0}return!1},tt=e=>Array.isArray(e)?e.join(""):e,st=(e,t)=>Array.isArray(e)?e.reduce((e,s)=>(((e,t)=>{const s=Object.keys(e);for(let r=0;r<s.length;r+=1)if(t[s[r]]&&t[s[r]].includes(e[s[r]]))return!0;return!1})(s,t)?e.priority.push(s):e.default.push(s),e),{priority:[],default:[]}):{default:e,priority:[]},rt=(e,t)=>d(c({},e),{[t]:void 0}),nt=["noscript","script","style"],it=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),ot=e=>Object.keys(e).reduce((t,s)=>{const r=void 0!==e[s]?`${s}="${e[s]}"`:`${s}`;return t?`${t} ${r}`:r},""),at=(e,t={})=>Object.keys(e).reduce((t,s)=>(t[Me[s]||s]=e[s],t),t),lt=(e,t)=>t.map((t,s)=>{const r={key:s,[Be]:!0};return Object.keys(t).forEach(e=>{const s=Me[e]||e;if("innerHTML"===s||"cssText"===s){const e=t.innerHTML||t.cssText;r.dangerouslySetInnerHTML={__html:e}}else r[s]=t[e]}),y.createElement(e,r)}),ct=(e,t,s=!0)=>{switch(e){case"title":return{toComponent:()=>((e,t,s)=>{const r=at(s,{key:t,[Be]:!0});return[y.createElement("title",r,t)]})(0,t.title,t.titleAttributes),toString:()=>((e,t,s,r)=>{const n=ot(s),i=tt(t);return n?`<${e} ${Be}="true" ${n}>${it(i,r)}</${e}>`:`<${e} ${Be}="true">${it(i,r)}</${e}>`})(e,t.title,t.titleAttributes,s)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>at(t),toString:()=>ot(t)};default:return{toComponent:()=>lt(e,t),toString:()=>((e,t,s=!0)=>t.reduce((t,r)=>{const n=r,i=Object.keys(n).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const r=void 0===n[t]?t:`${t}="${it(n[t],s)}"`;return e?`${e} ${r}`:r},""),o=n.innerHTML||n.cssText||"",a=-1===nt.indexOf(e);return`${t}<${e} ${Be}="true" ${i}${a?"/>":`>${o}</${e}>`}`},""))(e,t,s)}}},dt=e=>{const{baseTag:t,bodyAttributes:s,encode:r=!0,htmlAttributes:n,noscriptTags:i,styleTags:o,title:a="",titleAttributes:l,prioritizeSeoTags:c}=e;let{linkTags:d,metaTags:u,scriptTags:h}=e,f={toComponent:()=>{},toString:()=>""};return c&&({priorityMethods:f,linkTags:d,metaTags:u,scriptTags:h}=(({metaTags:e,linkTags:t,scriptTags:s,encode:r})=>{const n=st(e,De),i=st(t,Re),o=st(s,Le);return{priorityMethods:{toComponent:()=>[...lt("meta",n.priority),...lt("link",i.priority),...lt("script",o.priority)],toString:()=>`${ct("meta",n.priority,r)} ${ct("link",i.priority,r)} ${ct("script",o.priority,r)}`},metaTags:n.default,linkTags:i.default,scriptTags:o.default}})(e)),{priority:f,base:ct("base",t,r),bodyAttributes:ct("bodyAttributes",s,r),htmlAttributes:ct("htmlAttributes",n,r),link:ct("link",d,r),meta:ct("meta",u,r),noscript:ct("noscript",i,r),script:ct("script",h,r),style:ct("style",o,r),title:ct("title",{title:a,titleAttributes:l},r)}},ut=[],ht=!("undefined"==typeof window||!window.document||!window.document.createElement),ft=class{constructor(e,t){h(this,"instances",[]),h(this,"canUseDOM",ht),h(this,"context"),h(this,"value",{setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?ut:this.instances,add:e=>{(this.canUseDOM?ut:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?ut:this.instances).indexOf(e);(this.canUseDOM?ut:this.instances).splice(t,1)}}}),this.context=e,this.canUseDOM=t||!1,t||(e.helmet=dt({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},mt=y.createContext({}),pt=(e=class extends m.Component{constructor(t){super(t),h(this,"helmetData"),this.helmetData=new ft(this.props.context||{},e.canUseDOM)}render(){return y.createElement(mt.Provider,{value:this.helmetData.value},this.props.children)}},h(e,"canUseDOM",ht),e),gt=(e,t)=>{const s=document.head||document.querySelector("head"),r=s.querySelectorAll(`${e}[${Be}]`),n=[].slice.call(r),i=[];let o;return t&&t.length&&t.forEach(t=>{const s=document.createElement(e);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))if("innerHTML"===e)s.innerHTML=t.innerHTML;else if("cssText"===e)s.styleSheet?s.styleSheet.cssText=t.cssText:s.appendChild(document.createTextNode(t.cssText));else{const r=e,n=void 0===t[r]?"":t[r];s.setAttribute(e,n)}s.setAttribute(Be,"true"),n.some((e,t)=>(o=t,s.isEqualNode(e)))?n.splice(o,1):i.push(s)}),n.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),i.forEach(e=>s.appendChild(e)),{oldTags:n,newTags:i}},yt=(e,t)=>{const s=document.getElementsByTagName(e)[0];if(!s)return;const r=s.getAttribute(Be),n=r?r.split(","):[],i=[...n],o=Object.keys(t);for(const a of o){const e=t[a]||"";s.getAttribute(a)!==e&&s.setAttribute(a,e),-1===n.indexOf(a)&&n.push(a);const r=i.indexOf(a);-1!==r&&i.splice(r,1)}for(let a=i.length-1;a>=0;a-=1)s.removeAttribute(i[a]);n.length===i.length?s.removeAttribute(Be):s.getAttribute(Be)!==o.join(",")&&s.setAttribute(Be,o.join(","))},bt=(e,t)=>{const{baseTag:s,bodyAttributes:r,htmlAttributes:n,linkTags:i,metaTags:o,noscriptTags:a,onChangeClientState:l,scriptTags:c,styleTags:d,title:u,titleAttributes:h}=e;yt("body",r),yt("html",n),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=tt(e)),yt("title",t)})(u,h);const f={baseTag:gt("base",s),linkTags:gt("link",i),metaTags:gt("meta",o),noscriptTags:gt("noscript",a),scriptTags:gt("script",c),styleTags:gt("style",d)},m={},p={};Object.keys(f).forEach(e=>{const{newTags:t,oldTags:s}=f[e];t.length&&(m[e]=t),s.length&&(p[e]=f[e].oldTags)}),t&&t(),l(e,m,p)},vt=null,xt=e=>{vt&&cancelAnimationFrame(vt),e.defer?vt=requestAnimationFrame(()=>{bt(e,()=>{vt=null})}):(bt(e),vt=null)},wt=class extends m.Component{constructor(){super(...arguments),h(this,"rendered",!1)}shouldComponentUpdate(e){return!Ie(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let s=null;const r=(n=e.get().map(e=>{const t=c({},e.props);return delete t.context,t}),{baseTag:Xe(["href"],n),bodyAttributes:Qe("bodyAttributes",n),defer:Ve(n,Fe),encode:Ve(n,He),htmlAttributes:Qe("htmlAttributes",n),linkTags:Ze("link",["rel","href"],n),metaTags:Ze("meta",["name","charset","http-equiv","property","itemprop"],n),noscriptTags:Ze("noscript",["innerHTML"],n),onChangeClientState:Ye(n),scriptTags:Ze("script",["src","innerHTML"],n),styleTags:Ze("style",["cssText"],n),title:Ge(n),titleAttributes:Qe("titleAttributes",n),prioritizeSeoTags:et(n,Ke)});var n;pt.canUseDOM?xt(r):dt&&(s=dt(r)),t(s)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},_t=(t=class extends m.Component{shouldComponentUpdate(e){return!Ae(rt(this.props,"helmetData"),rt(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,s,r){return d(c({},t),{[e.type]:[...t[e.type]||[],c(c({},s),this.mapNestedChildrenToProps(e,r))]})}mapObjectTypeChildren(e,t,s,r){switch(e.type){case"title":return d(c({},t),{[e.type]:r,titleAttributes:c({},s)});case"body":return d(c({},t),{bodyAttributes:c({},s)});case"html":return d(c({},t),{htmlAttributes:c({},s)});default:return d(c({},t),{[e.type]:c({},s)})}}mapArrayTypeChildrenToProps(e,t){let s=c({},t);return Object.keys(e).forEach(t=>{s=d(c({},s),{[t]:e[t]})}),s}warnOnInvalidChildren(e,t){return Pe(Ue.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${Ue.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),Pe(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let s={};return y.Children.forEach(e,e=>{if(!e||!e.props)return;const r=e.props,{children:n}=r,i=u(r,["children"]),o=Object.keys(i).reduce((e,t)=>(e[ze[t]||t]=i[t],e),{});let{type:a}=e;switch("symbol"==typeof a?a=a.toString():this.warnOnInvalidChildren(e,n),a){case"Symbol(react.fragment)":t=this.mapChildrenToProps(n,t);break;case"link":case"meta":case"noscript":case"script":case"style":s=this.flattenArrayTypeChildren(e,s,o,n);break;default:t=this.mapObjectTypeChildren(e,t,o,n)}}),this.mapArrayTypeChildrenToProps(s,t)}render(){const e=this.props,{children:t}=e,s=u(e,["children"]);let r=c({},s),{helmetData:n}=s;if(t&&(r=this.mapChildrenToProps(t,r)),n&&!(n instanceof ft)){n=new ft(n.context,!0),delete r.helmetData}return n?y.createElement(wt,d(c({},r),{context:n.value})):y.createElement(mt.Consumer,null,e=>y.createElement(wt,d(c({},r),{context:e})))}},h(t,"defaultProps",{defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1}),t);const jt=()=>{const[e,t]=m.useState(!0),[s,r]=m.useState(!1),[n,i]=m.useState(!1),[o,a]=m.useState(null);m.useEffect(()=>{t(navigator.onLine);const e=()=>t(!0),s=()=>t(!1),n=e=>{e.preventDefault(),a(e)};return(()=>{const e=window.matchMedia&&window.matchMedia("(display-mode: standalone)").matches;i(e),r(e)})(),window.addEventListener("online",e),window.addEventListener("offline",s),window.addEventListener("beforeinstallprompt",n),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s),window.removeEventListener("beforeinstallprompt",n)}},[]);return{isOnline:e,isInstalled:s,isStandalone:n,canInstall:!!o,triggerInstall:()=>f(void 0,null,function*(){if(o){o.prompt();const{outcome:e}=yield o.userChoice;"accepted"===e&&(a(null),r(!0))}}),saveOfflineData:(e,t)=>{try{return localStorage.setItem(`pwa_${e}`,JSON.stringify({data:t,timestamp:Date.now()})),!0}catch(s){return!1}},getOfflineData:e=>{try{const t=localStorage.getItem(`pwa_${e}`);if(t){const e=JSON.parse(t);if(Date.now()-e.timestamp<6048e5)return e.data}return null}catch(t){return null}},clearOfflineData:e=>{try{return localStorage.removeItem(`pwa_${e}`),!0}catch(t){return!1}},getOfflineDataKeys:()=>{try{return Object.keys(localStorage).filter(e=>e.startsWith("pwa_")).map(e=>e.replace("pwa_",""))}catch(e){return[]}},requestNotificationPermission:()=>f(void 0,null,function*(){if("Notification"in window){return"granted"===(yield Notification.requestPermission())}return!1}),sendNotification:(e,t={})=>"Notification"in window&&"granted"===Notification.permission?new Notification(e,c({icon:"/icons/icon-192x192.png",badge:"/icons/icon-72x72.png"},t)):null}},kt=({isOpen:e,onClose:t})=>{const{isOnline:s,isInstalled:r,isStandalone:n,clearOfflineData:i,getOfflineDataKeys:o,requestNotificationPermission:a,sendNotification:l}=jt(),[c,d]=m.useState("default"),[u,h]=m.useState([]);m.useEffect(()=>{e&&("Notification"in window&&d(Notification.permission),h(o()))},[e,o]);const p=e=>{try{const t=localStorage.getItem(`pwa_${e}`);return t?Math.round(t.length/1024):0}catch(t){return 0}};return e?we.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:we.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:we.jsxs("div",{className:"p-6",children:[we.jsxs("div",{className:"flex items-center justify-between mb-6",children:[we.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center space-x-2",children:[we.jsx(T,{className:"h-5 w-5"}),we.jsx("span",{children:"PWA Settings"})]}),we.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"Ã—"})]}),we.jsxs("div",{className:"space-y-4",children:[we.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[we.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"App Status"}),we.jsxs("div",{className:"space-y-2 text-sm",children:[we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsx("span",{className:"text-gray-600",children:"Connection:"}),we.jsx("span",{className:"font-medium "+(s?"text-green-600":"text-red-600"),children:s?"Online":"Offline"})]}),we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsx("span",{className:"text-gray-600",children:"Installation:"}),we.jsx("span",{className:"font-medium "+(r?"text-green-600":"text-gray-600"),children:r?"Installed":"Not Installed"})]}),we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsx("span",{className:"text-gray-600",children:"Mode:"}),we.jsx("span",{className:"font-medium "+(n?"text-blue-600":"text-gray-600"),children:n?"Standalone":"Browser"})]})]})]}),we.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[we.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center space-x-2",children:[we.jsx(E,{className:"h-4 w-4"}),we.jsx("span",{children:"Notifications"})]}),we.jsxs("div",{className:"space-y-3",children:[we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsx("span",{className:"text-sm text-gray-600",children:"Permission:"}),we.jsx("span",{className:"text-sm font-medium "+("granted"===c?"text-green-600":"denied"===c?"text-red-600":"text-yellow-600"),children:c})]}),"granted"!==c&&we.jsx("button",{onClick:()=>f(void 0,null,function*(){const e=yield a();d(e?"granted":"denied"),e&&l("Notifications Enabled",{body:"You'll now receive updates about new features and templates!"})}),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors",children:"Enable Notifications"}),"granted"===c&&we.jsx("button",{onClick:()=>l("Test Notification",{body:"This is a test notification from AI Resume Pro!"}),className:"w-full bg-gray-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-gray-700 transition-colors",children:"Test Notification"})]})]}),we.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[we.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center space-x-2",children:[we.jsx(O,{className:"h-4 w-4"}),we.jsx("span",{children:"Offline Data"})]}),we.jsx("div",{className:"space-y-3",children:0===u.length?we.jsx("p",{className:"text-sm text-gray-500",children:"No offline data stored"}):we.jsxs("div",{className:"space-y-2",children:[u.map(e=>we.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border",children:[we.jsxs("div",{children:[we.jsx("p",{className:"text-sm font-medium text-gray-900",children:e}),we.jsxs("p",{className:"text-xs text-gray-500",children:[p(e)," KB"]})]}),we.jsx("button",{onClick:()=>(e=>{i(e)&&h(o())})(e),className:"text-red-500 hover:text-red-700 transition-colors",children:we.jsx(C,{className:"h-4 w-4"})})]},e)),we.jsx("button",{onClick:()=>{window.confirm("Are you sure you want to clear all offline data? This cannot be undone.")&&(u.forEach(e=>i(e)),h([]))},className:"w-full bg-red-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-red-700 transition-colors",children:"Clear All Data"})]})})]}),we.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[we.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center space-x-2",children:[we.jsx(A,{className:"h-4 w-4"}),we.jsx("span",{children:"PWA Features"})]}),we.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[we.jsxs("div",{className:"flex items-center space-x-2",children:[we.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),we.jsx("span",{children:"Offline resume creation"})]}),we.jsxs("div",{className:"flex items-center space-x-2",children:[we.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),we.jsx("span",{children:"App-like experience"})]}),we.jsxs("div",{className:"flex items-center space-x-2",children:[we.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),we.jsx("span",{children:"Automatic updates"})]}),we.jsxs("div",{className:"flex items-center space-x-2",children:[we.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),we.jsx("span",{children:"Push notifications"})]})]})]})]})]})})}):null};class Nt extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class St extends Nt{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Tt extends Nt{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Et extends Nt{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ot,Ct;(Ct=Ot||(Ot={})).Any="any",Ct.ApNortheast1="ap-northeast-1",Ct.ApNortheast2="ap-northeast-2",Ct.ApSouth1="ap-south-1",Ct.ApSoutheast1="ap-southeast-1",Ct.ApSoutheast2="ap-southeast-2",Ct.CaCentral1="ca-central-1",Ct.EuCentral1="eu-central-1",Ct.EuWest1="eu-west-1",Ct.EuWest2="eu-west-2",Ct.EuWest3="eu-west-3",Ct.SaEast1="sa-east-1",Ct.UsEast1="us-east-1",Ct.UsWest1="us-west-1",Ct.UsWest2="us-west-2";var At=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class Pt{constructor(e,{headers:t={},customFetch:s,region:r=Ot.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Ne(()=>f(void 0,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Jt);return{default:e}}),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return At(this,void 0,void 0,function*(){try{const{headers:r,method:n,body:i}=t;let o,a={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(a["x-region"]=l),i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",o=i):"string"==typeof i?(a["Content-Type"]="text/plain",o=i):"undefined"!=typeof FormData&&i instanceof FormData?o=i:(a["Content-Type"]="application/json",o=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:n||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),r),body:o}).catch(e=>{throw new St(e)}),d=c.headers.get("x-relay-error");if(d&&"true"===d)throw new Tt(c);if(!c.ok)throw new Et(c);let u,h=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return u="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"text/event-stream"===h?c:"multipart/form-data"===h?yield c.formData():yield c.text(),{data:u,error:null}}catch(r){return{data:null,error:r}}})}}var It={},$t={},Rt={},Lt={},Dt={},Ut={},Mt=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const zt=Mt.fetch,Bt=Mt.fetch.bind(Mt),qt=Mt.Headers,Ft=Mt.Request,Ht=Mt.Response,Jt=Object.freeze(Object.defineProperty({__proto__:null,Headers:qt,Request:Ft,Response:Ht,default:Bt,fetch:zt},Symbol.toStringTag,{value:"Module"})),Wt=b(Jt);var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0});let Vt=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Kt.default=Vt;var Gt=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ut,"__esModule",{value:!0});const Yt=Gt(Wt),Qt=Gt(Kt);Ut.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=Yt.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(e=>f(this,null,function*(){var t,s,r;let n=null,i=null,o=null,a=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=yield e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(o=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(n={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,o=null,a=406,l="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=yield e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(i=[],n=null,a=200,l="OK")}catch(c){404===e.status&&""===t?(a=204,l="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null===(r=null==n?void 0:n.details)||void 0===r?void 0:r.includes("0 rows"))&&(n=null,a=200,l="OK"),n&&this.shouldThrowOnError)throw new Qt.default(n)}return{error:n,data:i,count:o,status:a,statusText:l}}));return this.shouldThrowOnError||(s=s.catch(e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}};var Xt=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Dt,"__esModule",{value:!0});const Zt=Xt(Ut);let es=class extends Zt.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:n=r}={}){const i=n?`${n}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const n=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:n=!1,format:i="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Dt.default=es;var ts=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Lt,"__esModule",{value:!0});const ss=ts(Dt);let rs=class extends ss.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let n="";"plain"===r?n="pl":"phrase"===r?n="ph":"websearch"===r&&(n="w");const i=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${n}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Lt.default=rs;var ns=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Rt,"__esModule",{value:!0});const is=ns(Lt);Rt.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let n=!1;const i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!n?"":('"'===e&&(n=!n),e)).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),new is.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new is.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:n=!0}={}){const i=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),n||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new is.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new is.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new is.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var os={},as={};Object.defineProperty(as,"__esModule",{value:!0}),as.version=void 0,as.version="0.0.0-automated",Object.defineProperty(os,"__esModule",{value:!0}),os.DEFAULT_HEADERS=void 0;const ls=as;os.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${ls.version}`};var cs=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($t,"__esModule",{value:!0});const ds=cs(Rt),us=cs(Lt),hs=os;$t.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},hs.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new ds.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:n}={}){let i;const o=new URL(`${this.url}/rpc/${e}`);let a;s||r?(i=s?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{o.searchParams.append(e,t)})):(i="POST",a=t);const l=Object.assign({},this.headers);return n&&(l.Prefer=`count=${n}`),new us.default({method:i,url:o,headers:l,schema:this.schemaName,body:a,fetch:this.fetch,allowEmpty:!1})}};var fs=v&&v.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(It,"__esModule",{value:!0}),It.PostgrestError=It.PostgrestBuilder=It.PostgrestTransformBuilder=It.PostgrestFilterBuilder=It.PostgrestQueryBuilder=It.PostgrestClient=void 0;const ms=fs($t);It.PostgrestClient=ms.default;const ps=fs(Rt);It.PostgrestQueryBuilder=ps.default;const gs=fs(Lt);It.PostgrestFilterBuilder=gs.default;const ys=fs(Dt);It.PostgrestTransformBuilder=ys.default;const bs=fs(Ut);It.PostgrestBuilder=bs.default;const vs=fs(Kt);It.PostgrestError=vs.default;var xs=It.default={PostgrestClient:ms.default,PostgrestQueryBuilder:ps.default,PostgrestFilterBuilder:gs.default,PostgrestTransformBuilder:ys.default,PostgrestBuilder:bs.default,PostgrestError:vs.default};const{PostgrestClient:ws,PostgrestQueryBuilder:_s,PostgrestFilterBuilder:js,PostgrestTransformBuilder:ks,PostgrestBuilder:Ns,PostgrestError:Ss}=xs;let Ts;Ts="undefined"==typeof window?require("ws"):window.WebSocket;const Es={"X-Client-Info":"realtime-js/2.11.10"};var Os,Cs,As,Ps,Is,$s,Rs,Ls,Ds,Us,Ms;(Cs=Os||(Os={}))[Cs.connecting=0]="connecting",Cs[Cs.open=1]="open",Cs[Cs.closing=2]="closing",Cs[Cs.closed=3]="closed",(Ps=As||(As={})).closed="closed",Ps.errored="errored",Ps.joined="joined",Ps.joining="joining",Ps.leaving="leaving",($s=Is||(Is={})).close="phx_close",$s.error="phx_error",$s.join="phx_join",$s.reply="phx_reply",$s.leave="phx_leave",$s.access_token="access_token",(Rs||(Rs={})).websocket="websocket",(Ds=Ls||(Ls={})).Connecting="connecting",Ds.Open="open",Ds.Closing="closing",Ds.Closed="closed";class zs{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),n=t.getUint8(2);let i=this.HEADER_LENGTH+2;const o=s.decode(e.slice(i,i+r));i+=r;const a=s.decode(e.slice(i,i+n));i+=n;return{ref:null,topic:o,event:a,payload:JSON.parse(s.decode(e.slice(i,e.byteLength)))}}}class Bs{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(Ms=Us||(Us={})).abstime="abstime",Ms.bool="bool",Ms.date="date",Ms.daterange="daterange",Ms.float4="float4",Ms.float8="float8",Ms.int2="int2",Ms.int4="int4",Ms.int4range="int4range",Ms.int8="int8",Ms.int8range="int8range",Ms.json="json",Ms.jsonb="jsonb",Ms.money="money",Ms.numeric="numeric",Ms.oid="oid",Ms.reltime="reltime",Ms.text="text",Ms.time="time",Ms.timestamp="timestamp",Ms.timestamptz="timestamptz",Ms.timetz="timetz",Ms.tsrange="tsrange",Ms.tstzrange="tstzrange";const qs=(e,t,s={})=>{var r;const n=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce((s,r)=>(s[r]=Fs(r,e,t,n),s),{})},Fs=(e,t,s,r)=>{const n=t.find(t=>t.name===e),i=null==n?void 0:n.type,o=s[e];return i&&!r.includes(i)?Hs(i,o):Js(o)},Hs=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return Gs(t,s)}switch(e){case Us.bool:return Ws(t);case Us.float4:case Us.float8:case Us.int2:case Us.int4:case Us.int8:case Us.numeric:case Us.oid:return Ks(t);case Us.json:case Us.jsonb:return Vs(t);case Us.timestamp:return Ys(t);case Us.abstime:case Us.date:case Us.daterange:case Us.int4range:case Us.int8range:case Us.money:case Us.reltime:case Us.text:case Us.time:case Us.timestamptz:case Us.timetz:case Us.tsrange:case Us.tstzrange:default:return Js(t)}},Js=e=>e,Ws=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Ks=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Vs=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Gs=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const i=e.slice(1,s);try{r=JSON.parse("["+i+"]")}catch(n){r=i?i.split(","):[]}return r.map(e=>Hs(t,e))}return e},Ys=e=>"string"==typeof e?e.replace(" ","T"):e,Qs=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Xs{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Zs,er,tr,sr,rr,nr,ir,or;(er=Zs||(Zs={})).SYNC="sync",er.JOIN="join",er.LEAVE="leave";class ar{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ar.syncState(this.state,e,t,s),this.pendingDiffs.forEach(e=>{this.state=ar.syncDiff(this.state,e,t,s)}),this.pendingDiffs=[],r()}),this.channel._on(s.diff,{},e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=ar.syncDiff(this.state,e,t,s),r())}),this.onJoin((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})}),this.onLeave((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const n=this.cloneDeep(e),i=this.transformState(t),o={},a={};return this.map(n,(e,t)=>{i[e]||(a[e]=t)}),this.map(i,(e,t)=>{const s=n[e];if(s){const r=t.map(e=>e.presence_ref),n=s.map(e=>e.presence_ref),i=t.filter(e=>n.indexOf(e.presence_ref)<0),l=s.filter(e=>r.indexOf(e.presence_ref)<0);i.length>0&&(o[e]=i),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(n,{joins:o,leaves:a},s,r)}static syncDiff(e,t,s,r){const{joins:n,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(n,(t,r)=>{var n;const i=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(r),i.length>0){const s=e[t].map(e=>e.presence_ref),r=i.filter(e=>s.indexOf(e.presence_ref)<0);e[t].unshift(...r)}s(t,i,r)}),this.map(i,(t,s)=>{let n=e[t];if(!n)return;const i=s.map(e=>e.presence_ref);n=n.filter(e=>i.indexOf(e.presence_ref)<0),e[t]=n,r(t,n,s),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(sr=tr||(tr={})).ALL="*",sr.INSERT="INSERT",sr.UPDATE="UPDATE",sr.DELETE="DELETE",(nr=rr||(rr={})).BROADCAST="broadcast",nr.PRESENCE="presence",nr.POSTGRES_CHANGES="postgres_changes",nr.SYSTEM="system",(or=ir||(ir={})).SUBSCRIBED="SUBSCRIBED",or.TIMED_OUT="TIMED_OUT",or.CLOSED="CLOSED",or.CHANNEL_ERROR="CHANNEL_ERROR";class lr{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=As.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Xs(this,Is.join,this.params,this.timeout),this.rejoinTimer=new Bs(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=As.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=As.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=As.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Is.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new ar(this),this.broadcastEndpointURL=Qs(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:n,presence:i,private:o}}=this.params;this._onError(t=>null==e?void 0:e(ir.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(ir.CLOSED));const a={},l={broadcast:n,presence:i,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map(e=>e.filter))&&void 0!==r?r:[],private:o};this.socket.accessTokenValue&&(a.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},a)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",t=>f(this,[t],function*({postgres_changes:t}){var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,n=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,i=[];for(let s=0;s<n;s++){const n=r[s],{filter:{event:o,schema:a,table:l,filter:c}}=n,d=t&&t[s];if(!d||d.event!==o||d.schema!==a||d.table!==l||d.filter!==c)return this.unsubscribe(),this.state=As.errored,void(null==e||e(ir.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},n),{id:d.id}))}return this.bindings.postgres_changes=i,void(e&&e(ir.SUBSCRIBED))}null==e||e(ir.SUBSCRIBED)})).receive("error",t=>{this.state=As.errored,null==e||e(ir.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(ir.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(e){return f(this,arguments,function*(e,t={}){return yield this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)})}untrack(){return f(this,arguments,function*(e={}){return yield this.send({type:"presence",event:"untrack"},e)})}on(e,t,s){return this._on(e,t,s)}send(e){return f(this,arguments,function*(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise(s=>{var r,n,i;const o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(n=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===n?void 0:n.broadcast)||void 0===i?void 0:i.ack)||s("ok"),o.receive("ok",()=>s("ok")),o.receive("error",()=>s("error")),o.receive("timeout",()=>s("timed out"))});{const{event:i,payload:o}=e,a={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const e=yield this._fetchWithTimeout(this.broadcastEndpointURL,a,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return yield null===(r=e.body)||void 0===r?void 0:r.cancel(),e.ok?"ok":"error"}catch(n){return"AbortError"===n.name?"timed out":"error"}}})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=As.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Is.close,"leave",this._joinRef())};return this.joinPush.destroy(),new Promise(s=>{const r=new Xs(this,Is.leave,{},e);r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}_fetchWithTimeout(e,t,s){return f(this,null,function*(){const r=new AbortController,n=setTimeout(()=>r.abort(),s),i=yield this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(n),i})}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Xs(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,n;const i=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=Is;if(s&&[o,a,l,c].indexOf(i)>=0&&s!==this._joinRef())return;let d=this._onMessage(i,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter(e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===i}).map(e=>e.callback(d,s)):null===(n=this.bindings[i])||void 0===n||n.filter(e=>{var s,r,n,o,a,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,o=null===(s=e.filter)||void 0===s?void 0:s.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{const s=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i}).map(e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:r,type:n,errors:i}=e,o={schema:t,table:s,commit_timestamp:r,eventType:n,new:{},old:{},errors:i};d=Object.assign(Object.assign({},o),this._getPayloadRecords(e))}e.callback(d,s)})}_isClosed(){return this.state===As.closed}_isJoined(){return this.state===As.joined}_isJoining(){return this.state===As.joining}_isLeaving(){return this.state===As.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),n={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(n):this.bindings[r]=[n],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&lr.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Is.close,{},e)}_onError(e){this._on(Is.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=As.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=qs(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=qs(e.columns,e.old_record)),t}}const cr=()=>{};class dr{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers=Es,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=cr,this.ref=0,this.logger=cr,this.conn=null,this.sendBuffer=[],this.serializer=new zs,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Ne(()=>f(this,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Jt);return{default:e}}),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${Rs.websocket}`,this.httpEndpoint=Qs(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),((null==t?void 0:t.logLevel)||(null==t?void 0:t.log_level))&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Bs(()=>f(this,null,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Ts),this.transport){const e="undefined"!=typeof window&&this.transport===window.WebSocket;return this.conn=e?new this.transport(this.endpointURL()):new this.transport(this.endpointURL(),void 0,{headers:this.headers}),void this.setupConnection()}this.conn=new ur(this.endpointURL(),void 0,{close:()=>{this.conn=null}})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(e=>e.teardown()))}getChannels(){return this.channels}removeChannel(e){return f(this,null,function*(){const t=yield e.unsubscribe();return this.channels=this.channels.filter(t=>t._joinRef!==e._joinRef),0===this.channels.length&&this.disconnect(),t})}removeAllChannels(){return f(this,null,function*(){const e=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e})}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Os.connecting:return Ls.Connecting;case Os.open:return Ls.Open;case Os.closing:return Ls.Closing;default:return Ls.Closed}}isConnected(){return this.connectionState()===Ls.Open}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(e=>e.topic===s);if(r)return r;{const s=new lr(`realtime:${e}`,t,this);return this.channels.push(s),s}}push(e){const{topic:t,event:s,payload:r,ref:n}=e,i=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${s} (${n})`,r),this.isConnected()?i():this.sendBuffer.push(i)}setAuth(e=null){return f(this,null,function*(){let t=e||this.accessToken&&(yield this.accessToken())||this.accessTokenValue;this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{t&&e.updateJoinPayload({access_token:t,version:this.headers&&this.headers["X-Client-Info"]}),e.joinedOnce&&e._isJoined()&&e._push(Is.access_token,{access_token:t})}))})}sendHeartbeat(){return f(this,null,function*(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),yield this.setAuth()}else this.heartbeatCallback("disconnected")})}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:s,payload:r,ref:n}=e;"phoenix"===t&&"phx_reply"===s&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),n&&n===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${n&&"("+n+")"||""}`,r),Array.from(this.channels).filter(e=>e._isMember(t)).forEach(e=>e._trigger(s,r,n)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Is.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class ur{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Os.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class hr extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function fr(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class mr extends hr{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class pr extends hr{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var gr=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const yr=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Ne(()=>f(void 0,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Jt);return{default:e}}),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},br=e=>{if(Array.isArray(e))return e.map(e=>br(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,s])=>{const r=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[r]=br(s)}),t};var vr=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const xr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),wr=(e,t,s)=>vr(void 0,void 0,void 0,function*(){const r=yield gr(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield Ne(()=>Promise.resolve().then(()=>Jt),void 0)).Response:Response});e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then(s=>{t(new mr(xr(s),e.status||500))}).catch(e=>{t(new pr(xr(e),e))}):t(new pr(xr(e),e))});function _r(e,t,s,r,n,i){return vr(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(s,((e,t,s,r)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(n.body=JSON.stringify(r)),Object.assign(Object.assign({},n),s))})(t,r,n,i)).then(e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>wr(e,a,r))})})}function jr(e,t,s,r){return vr(this,void 0,void 0,function*(){return _r(e,"GET",t,s,r)})}function kr(e,t,s,r,n){return vr(this,void 0,void 0,function*(){return _r(e,"POST",t,r,n,s)})}function Nr(e,t,s,r,n){return vr(this,void 0,void 0,function*(){return _r(e,"DELETE",t,r,n,s)})}var Sr=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const Tr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Er={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Or{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=yr(r)}uploadOrUpdate(e,t,s,r){return Sr(this,void 0,void 0,function*(){try{let n;const i=Object.assign(Object.assign({},Er),r);let o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const a=i.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(n=new FormData,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a)),n.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(n=s,n.append("cacheControl",i.cacheControl),a&&n.append("metadata",this.encodeMetadata(a))):(n=s,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,a&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(a)))),(null==r?void 0:r.headers)&&(o=Object.assign(Object.assign({},o),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:n,headers:o},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(n){if(fr(n))return{data:null,error:n};throw n}})}upload(e,t,s){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return Sr(this,void 0,void 0,function*(){const n=this._removeEmptyFolders(e),i=this._getFinalPath(n),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:Er.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const a=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:i}),l=yield a.json();if(a.ok)return{data:{path:n,fullPath:l.Key},error:null};return{data:null,error:l}}catch(a){if(fr(a))return{data:null,error:a};throw a}})}createSignedUploadUrl(e,t){return Sr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const n=yield kr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),i=new URL(this.url+n.url),o=i.searchParams.get("token");if(!o)throw new hr("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:o},error:null}}catch(s){if(fr(s))return{data:null,error:s};throw s}})}update(e,t,s){return Sr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return Sr(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}copy(e,t,s){return Sr(this,void 0,void 0,function*(){try{return{data:{path:(yield kr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return Sr(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),n=yield kr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return n={signedUrl:encodeURI(`${this.url}${n.signedURL}${i}`)},{data:n,error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return Sr(this,void 0,void 0,function*(){try{const r=yield kr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}download(e,t){return Sr(this,void 0,void 0,function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield jr(this.fetch,`${this.url}/${s}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(i){if(fr(i))return{data:null,error:i};throw i}})}info(e){return Sr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield jr(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:br(e),error:null}}catch(s){if(fr(s))return{data:null,error:s};throw s}})}exists(e){return Sr(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return vr(this,void 0,void 0,function*(){return _r(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(fr(s)&&s instanceof pr){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&r.push(n);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&r.push(o);let a=r.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${a}`)}}}remove(e){return Sr(this,void 0,void 0,function*(){try{return{data:yield Nr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(fr(t))return{data:null,error:t};throw t}})}list(e,t,s){return Sr(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Tr),t),{prefix:e||""});return{data:yield kr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(fr(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Cr={"X-Client-Info":"storage-js/2.7.1"};var Ar=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class Pr{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},Cr),t),this.fetch=yr(s)}listBuckets(){return Ar(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(fr(e))return{data:null,error:e};throw e}})}getBucket(e){return Ar(this,void 0,void 0,function*(){try{return{data:yield jr(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(fr(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ar(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(fr(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return Ar(this,void 0,void 0,function*(){try{const s=yield function(e,t,s,r,n){return vr(this,void 0,void 0,function*(){return _r(e,"PUT",t,r,n,s)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(fr(s))return{data:null,error:s};throw s}})}emptyBucket(e){return Ar(this,void 0,void 0,function*(){try{return{data:yield kr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(fr(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ar(this,void 0,void 0,function*(){try{return{data:yield Nr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(fr(t))return{data:null,error:t};throw t}})}}class Ir extends Pr{constructor(e,t={},s){super(e,t,s)}from(e){return new Or(this.url,this.headers,e,this.fetch)}}let $r="";$r="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Rr={headers:{"X-Client-Info":`supabase-js-${$r}/2.50.0`}},Lr={schema:"public"},Dr={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ur={};var Mr=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const zr=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?Bt:fetch),(...e)=>t(...e)})(s),n="undefined"==typeof Headers?qt:Headers;return(s,i)=>Mr(void 0,void 0,void 0,function*(){var o;const a=null!==(o=yield t())&&void 0!==o?o:e;let l=new n(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),r(s,Object.assign(Object.assign({},i),{headers:l}))})};var Br=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};const qr="2.70.0",Fr=3e4,Hr=9e4,Jr={"X-Client-Info":`gotrue-js/${qr}`},Wr="X-Supabase-Api-Version",Kr={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Vr=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Gr extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Yr(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Qr extends Gr{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class Xr extends Gr{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Zr extends Gr{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class en extends Zr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class tn extends Zr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sn extends Zr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class rn extends Zr{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class nn extends Zr{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class on extends Zr{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function an(e){return Yr(e)&&"AuthRetryableFetchError"===e.name}class ln extends Zr{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class cn extends Zr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const dn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),un=" \t\n\r=".split(""),hn=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<un.length;t+=1)e[un[t].charCodeAt(0)]=-2;for(let t=0;t<dn.length;t+=1)e[dn[t].charCodeAt(0)]=t;return e})();function fn(e,t,s){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(dn[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;s(dn[e]),t.queuedBits-=6}}function mn(e,t,s){const r=hn[e];if(!(r>-1)){if(-2===r)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)s(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function pn(e){const t=[],s=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=e=>{!function(e,t,s){if(0===t.utf8seq){if(e<=127)return void s(e);for(let s=1;s<6;s+=1)if(!(e>>7-s&1)){t.utf8seq=s;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&s(t.codepoint)}}(e,r,s)};for(let o=0;o<e.length;o+=1)mn(e.charCodeAt(o),n,i);return t.join("")}function gn(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function yn(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let n=0;n<e.length;n+=1)mn(e.charCodeAt(n),s,r);return new Uint8Array(t)}function bn(e){const t=[];return function(e,t){for(let s=0;s<e.length;s+=1){let r=e.charCodeAt(s);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(s+1)-56320&65535|t),s+=1}gn(r,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function vn(e){const t=[],s={queue:0,queuedBits:0},r=e=>{t.push(e)};return e.forEach(e=>fn(e,s,r)),fn(null,s,r),t.join("")}const xn=()=>"undefined"!=typeof window&&"undefined"!=typeof document,wn={tested:!1,writable:!1},_n=()=>{if(!xn())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(wn.tested)return wn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),wn.tested=!0,wn.writable=!0}catch(t){wn.tested=!0,wn.writable=!1}return wn.writable};const jn=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Ne(()=>f(void 0,null,function*(){const{default:e}=yield Promise.resolve().then(()=>Jt);return{default:e}}),void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},kn=(e,t,s)=>f(void 0,null,function*(){yield e.setItem(t,JSON.stringify(s))}),Nn=(e,t)=>f(void 0,null,function*(){const s=yield e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}}),Sn=(e,t)=>f(void 0,null,function*(){yield e.removeItem(t)});class Tn{constructor(){this.promise=new Tn.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function En(e){const t=e.split(".");if(3!==t.length)throw new cn("Invalid JWT structure");for(let s=0;s<t.length;s++)if(!Vr.test(t[s]))throw new cn("JWT not in base64url format");return{header:JSON.parse(pn(t[0])),payload:JSON.parse(pn(t[1])),signature:yn(t[2]),raw:{header:t[0],payload:t[1]}}}function On(e){return("0"+e.toString(16)).substr(-2)}function Cn(e){return f(this,null,function*(){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=yield function(e){return f(this,null,function*(){const t=(new TextEncoder).encode(e),s=yield crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(e=>String.fromCharCode(e)).join("")})}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function An(e,t,s=!1){return f(this,null,function*(){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,On).join("")}();let n=r;s&&(n+="/PASSWORD_RECOVERY"),yield kn(e,`${t}-code-verifier`,n);const i=yield Cn(r);return[i,r===i?"plain":"s256"]})}Tn.promiseConstructor=Promise;const Pn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const In=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function $n(e){if(!In.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}const Rn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Ln=[502,503,504];function Dn(e){return f(this,null,function*(){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new on(Rn(e),0);if(Ln.includes(e.status))throw new on(Rn(e),e.status);let r,n;try{r=yield e.json()}catch(o){throw new Xr(Rn(o),o)}const i=function(e){const t=e.headers.get(Wr);if(!t)return null;if(!t.match(Pn))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(o){return null}}(e);if(i&&i.getTime()>=Kr.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?n=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(n=r.error_code),n){if("weak_password"===n)throw new ln(Rn(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===n)throw new en}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new ln(Rn(r),e.status,r.weak_password.reasons);throw new Qr(Rn(r),e.status||500,n)})}function Un(e,t,s,r){return f(this,null,function*(){var n;const i=Object.assign({},null==r?void 0:r.headers);i[Wr]||(i[Wr]=Kr.name),(null==r?void 0:r.jwt)&&(i.Authorization=`Bearer ${r.jwt}`);const o=null!==(n=null==r?void 0:r.query)&&void 0!==n?n:{};(null==r?void 0:r.redirectTo)&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield function(e,t,s,r,n,i){return f(this,null,function*(){const o=((e,t,s,r)=>{const n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(r),Object.assign(Object.assign({},n),s))})(t,r,n,i);let a;try{a=yield e(s,Object.assign({},o))}catch(l){throw new on(Rn(l),0)}if(a.ok||(yield Dn(a)),null==r?void 0:r.noResolveJson)return a;try{return yield a.json()}catch(l){yield Dn(l)}})}(e,t,s+a,{headers:i,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}})}function Mn(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function zn(e){const t=Mn(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Bn(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function qn(e){return{data:e,error:null}}function Fn(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i}=e,o=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:n,verification_type:i},user:Object.assign({},o)},error:null}}function Hn(e){return e}const Jn=["global","local","others"];class Wn{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=jn(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(e){return f(this,arguments,function*(e,t=Jn[0]){if(Jn.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Jn.join(", ")}`);try{return yield Un(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Yr(s))return{data:null,error:s};throw s}})}inviteUserByEmail(e){return f(this,arguments,function*(e,t={}){try{return yield Un(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Bn})}catch(s){if(Yr(s))return{data:{user:null},error:s};throw s}})}generateLink(e){return f(this,null,function*(){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)t.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(e,r[n])&&(s[r[n]]=e[r[n]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),yield Un(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Fn,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Yr(t))return{data:{properties:null,user:null},error:t};throw t}})}createUser(e){return f(this,null,function*(){try{return yield Un(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Bn})}catch(t){if(Yr(t))return{data:{user:null},error:t};throw t}})}listUsers(e){return f(this,null,function*(){var t,s,r,n,i,o,a;try{const l={nextPage:null,lastPage:0,total:0},c=yield Un(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(n=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==n?n:""},xform:Hn});if(c.error)throw c.error;const d=yield c.json(),u=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Yr(l))return{data:{users:[]},error:l};throw l}})}getUserById(e){return f(this,null,function*(){$n(e);try{return yield Un(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Bn})}catch(t){if(Yr(t))return{data:{user:null},error:t};throw t}})}updateUserById(e,t){return f(this,null,function*(){$n(e);try{return yield Un(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Bn})}catch(s){if(Yr(s))return{data:{user:null},error:s};throw s}})}deleteUser(e,t=!1){return f(this,null,function*(){$n(e);try{return yield Un(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Bn})}catch(s){if(Yr(s))return{data:{user:null},error:s};throw s}})}_listFactors(e){return f(this,null,function*(){$n(e.userId);try{const{data:t,error:s}=yield Un(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}_deleteFactor(e){return f(this,null,function*(){$n(e.userId),$n(e.id);try{return{data:yield Un(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}}const Kn={getItem:e=>_n()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{_n()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{_n()&&globalThis.localStorage.removeItem(e)}};function Vn(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const Gn=!!(globalThis&&_n()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Yn extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Qn extends Yn{}function Xn(e,t,s){return f(this,null,function*(){const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort()},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},r=>f(this,null,function*(){if(!r){if(0===t)throw new Qn(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gn)try{yield globalThis.navigator.locks.query()}catch(n){}return yield s()}try{return yield s()}finally{}})))})}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Zn={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Jr,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function ei(e,t,s){return f(this,null,function*(){return yield s()})}class ti{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=ti.nextInstanceID,ti.nextInstanceID+=1,this.instanceID>0&&xn();const r=Object.assign(Object.assign({},Zn),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new Wn({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=jn(r.fetch),this.lock=r.lock||ei,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:xn()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Xn:this.lock=ei,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:_n()?this.storage=Kn:(this.memoryStorage={},this.storage=Vn(this.memoryStorage)):(this.memoryStorage={},this.storage=Vn(this.memoryStorage)),xn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(n){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",e=>f(this,null,function*(){this._debug("received broadcast notification from other tab or client",e),yield this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${qr}) ${(new Date).toISOString()}`,...e),this}initialize(){return f(this,null,function*(){return this.initializePromise||(this.initializePromise=(()=>f(this,null,function*(){return yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._initialize()}))}))()),yield this.initializePromise})}_initialize(){return f(this,null,function*(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach((e,s)=>{t[s]=e})}catch(r){}return s.searchParams.forEach((e,s)=>{t[s]=e}),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":(yield this._isPKCECallback(t))&&(s="pkce"),xn()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:n}=yield this._getSessionFromURL(t,s);if(n){if(this._debug("#_initialize()","error detecting session from URL",n),function(e){return Yr(e)&&"AuthImplicitGrantRedirectError"===e.name}(n)){const t=null===(e=n.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:n}}return yield this._removeSession(),{error:n}}const{session:i,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),yield this._saveSession(i),setTimeout(()=>f(this,null,function*(){"recovery"===o?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",i):yield this._notifyAllSubscribers("SIGNED_IN",i)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(t){return Yr(t)?{error:t}:{error:new Xr("Unexpected error during initialization",t)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return f(this,null,function*(){var t,s,r;try{const n=yield Un(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:Mn}),{data:i,error:o}=n;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(Yr(n))return{data:{user:null,session:null},error:n};throw n}})}signUp(e){return f(this,null,function*(){var t,s,r;try{let n;if("email"in e){const{email:s,password:r,options:i}=e;let o=null,a=null;"pkce"===this.flowType&&([o,a]=yield An(this.storage,this.storageKey)),n=yield Un(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:o,code_challenge_method:a},xform:Mn})}else{if(!("phone"in e))throw new sn("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:o}=e;n=yield Un(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(s=null==o?void 0:o.data)&&void 0!==s?s:{},channel:null!==(r=null==o?void 0:o.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:Mn})}}const{data:i,error:o}=n;if(o||!i)return{data:{user:null,session:null},error:o};const a=i.session,l=i.user;return i.session&&(yield this._saveSession(i.session),yield this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(n){if(Yr(n))return{data:{user:null,session:null},error:n};throw n}})}signInWithPassword(e){return f(this,null,function*(){try{let t;if("email"in e){const{email:s,password:r,options:n}=e;t=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:zn})}else{if(!("phone"in e))throw new sn("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:n}=e;t=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:zn})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new tn}}catch(t){if(Yr(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOAuth(e){return f(this,null,function*(){var t,s,r,n;return yield this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})})}exchangeCodeForSession(e){return f(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>f(this,null,function*(){return this._exchangeCodeForSession(e)}))})}signInWithWeb3(e){return f(this,null,function*(){const{chain:t}=e;if("solana"===t)return yield this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)})}signInWithSolana(e){return f(this,null,function*(){var t,s,r,n,i,o,a,l,c,d,u,h;let f,m;if("message"in e)f=e.message,m=e.signature;else{const{chain:u,wallet:h,statement:p,options:g}=e;let y;if(xn())if("object"==typeof h)y=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");y=e.solana}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=h}const b=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in y&&y.signIn){const e=yield y.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:b.host,uri:b.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in y&&"function"==typeof y.signMessage&&"publicKey"in y&&"object"==typeof y&&y.publicKey&&"toBase58"in y.publicKey&&"function"==typeof y.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${b.host} wants you to sign in with your Solana account:`,y.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${b.href}`,`Issued At: ${null!==(r=null===(s=null==g?void 0:g.signInWithSolana)||void 0===s?void 0:s.issuedAt)&&void 0!==r?r:(new Date).toISOString()}`,...(null===(n=null==g?void 0:g.signInWithSolana)||void 0===n?void 0:n.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(d=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=yield y.signMessage((new TextEncoder).encode(f),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:s}=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:vn(m)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:Mn});if(s)throw s;return t&&t.session&&t.user?(t.session&&(yield this._saveSession(t.session),yield this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:s}):{data:{user:null,session:null},error:new tn}}catch(p){if(Yr(p))return{data:{user:null,session:null},error:p};throw p}})}_exchangeCodeForSession(e){return f(this,null,function*(){const t=yield Nn(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:n}=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Mn});if(yield Sn(this.storage,`${this.storageKey}-code-verifier`),n)throw n;return t&&t.session&&t.user?(t.session&&(yield this._saveSession(t.session),yield this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:n}):{data:{user:null,session:null,redirectType:null},error:new tn}}catch(n){if(Yr(n))return{data:{user:null,session:null,redirectType:null},error:n};throw n}})}signInWithIdToken(e){return f(this,null,function*(){try{const{options:t,provider:s,token:r,access_token:n,nonce:i}=e,o=yield Un(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:n,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Mn}),{data:a,error:l}=o;return l?{data:{user:null,session:null},error:l}:a&&a.session&&a.user?(a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:a,error:l}):{data:{user:null,session:null},error:new tn}}catch(t){if(Yr(t))return{data:{user:null,session:null},error:t};throw t}})}signInWithOtp(e){return f(this,null,function*(){var t,s,r,n,i;try{if("email"in e){const{email:r,options:n}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=yield An(this.storage,this.storageKey));const{error:a}=yield Un(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(s=null==n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:i,code_challenge_method:o},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:t,options:s}=e,{data:o,error:a}=yield Un(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(n=null==s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(i=null==s?void 0:s.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new sn("You must provide either an email or phone number.")}catch(o){if(Yr(o))return{data:{user:null,session:null},error:o};throw o}})}verifyOtp(e){return f(this,null,function*(){var t,s;try{let r,n;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:i,error:o}=yield Un(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:r,xform:Mn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const a=i.session,l=i.user;return(null==a?void 0:a.access_token)&&(yield this._saveSession(a),yield this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(r){if(Yr(r))return{data:{user:null,session:null},error:r};throw r}})}signInWithSSO(e){return f(this,null,function*(){var t,s,r;try{let n=null,i=null;return"pkce"===this.flowType&&([n,i]=yield An(this.storage,this.storageKey)),yield Un(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:i}),headers:this.headers,xform:qn})}catch(n){if(Yr(n))return{data:null,error:n};throw n}})}reauthenticate(){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return f(this,null,function*(){try{return yield this._useSession(e=>f(this,null,function*(){const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new en;const{error:r}=yield Un(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Yr(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return f(this,null,function*(){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:n}=e,{error:i}=yield Un(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:s,type:r,options:n}=e,{data:i,error:o}=yield Un(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new sn("You must provide either an email or phone number and a type")}catch(t){if(Yr(t))return{data:{user:null,session:null},error:t};throw t}})}getSession(){return f(this,null,function*(){yield this.initializePromise;return yield this._acquireLock(-1,()=>f(this,null,function*(){return this._useSession(e=>f(this,null,function*(){return e}))}))})}_acquireLock(e,t){return f(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(()=>f(this,null,function*(){return yield e,yield t()}))();return this.pendingInLock.push((()=>f(this,null,function*(){try{yield s}catch(e){}}))()),s}return yield this.lock(`lock:${this.storageKey}`,e,()=>f(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((()=>f(this,null,function*(){try{yield e}catch(t){}}))()),yield e;this.pendingInLock.length;){const e=[...this.pendingInLock];yield Promise.all(e),this.pendingInLock.splice(0,e.length)}return yield e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return f(this,null,function*(){this._debug("#_useSession","begin");try{const t=yield this.__loadSession();return yield e(t)}finally{this._debug("#_useSession","end")}})}__loadSession(){return f(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=yield Nn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&1e3*e.expires_at-Date.now()<Hr;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:n}=yield this._callRefreshToken(e.refresh_token);return n?{data:{session:null},error:n}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return f(this,null,function*(){if(e)return yield this._getUser(e);yield this.initializePromise;return yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._getUser()}))})}_getUser(e){return f(this,null,function*(){try{return e?yield Un(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Bn}):yield this._useSession(e=>f(this,null,function*(){var t,s,r;const{data:n,error:i}=e;if(i)throw i;return(null===(t=n.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?yield Un(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:Bn}):{data:{user:null},error:new en}}))}catch(t){if(Yr(t))return function(e){return Yr(e)&&"AuthSessionMissingError"===e.name}(t)&&(yield this._removeSession(),yield Sn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}})}updateUser(e){return f(this,arguments,function*(e,t={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._updateUser(e,t)}))})}_updateUser(e){return f(this,arguments,function*(e,t={}){try{return yield this._useSession(s=>f(this,null,function*(){const{data:r,error:n}=s;if(n)throw n;if(!r.session)throw new en;const i=r.session;let o=null,a=null;"pkce"===this.flowType&&null!=e.email&&([o,a]=yield An(this.storage,this.storageKey));const{data:l,error:c}=yield Un(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:i.access_token,xform:Bn});if(c)throw c;return i.user=l.user,yield this._saveSession(i),yield this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(s){if(Yr(s))return{data:{user:null},error:s};throw s}})}setSession(e){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return f(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new en;const t=Date.now()/1e3;let s=t,r=!0,n=null;const{payload:i}=En(e.access_token);if(i.exp&&(s=i.exp,r=s<=t),r){const{session:t,error:s}=yield this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};n=t}else{const{data:r,error:i}=yield this._getUser(e.access_token);if(i)throw i;n={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},yield this._saveSession(n),yield this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(t){if(Yr(t))return{data:{session:null,user:null},error:t};throw t}})}refreshSession(e){return f(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var s;if(!e){const{data:r,error:n}=t;if(n)throw n;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new en;const{session:r,error:n}=yield this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Yr(t))return{data:{user:null,session:null},error:t};throw t}})}_getSessionFromURL(e,t){return f(this,null,function*(){try{if(!xn())throw new rn("No browser detected.");if(e.error||e.error_description||e.error_code)throw new rn(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new nn("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new rn("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new nn("No code detected.");const{data:t,error:s}=yield this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:n,refresh_token:i,expires_in:o,expires_at:a,token_type:l}=e;if(!(n&&o&&i&&l))throw new rn("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(o);let u=c+d;a&&(u=parseInt(a));const{data:h,error:f}=yield this._getUser(n);if(f)throw f;const m={provider_token:s,provider_refresh_token:r,access_token:n,expires_in:d,expires_at:u,refresh_token:i,token_type:l,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(s){if(Yr(s))return{data:{session:null,redirectType:null},error:s};throw s}})}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}_isPKCECallback(e){return f(this,null,function*(){const t=yield Nn(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)})}signOut(){return f(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return f(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(t=>f(this,null,function*(){var s;const{data:r,error:n}=t;if(n)return{error:n};const i=null===(s=r.session)||void 0===s?void 0:s.access_token;if(i){const{error:t}=yield this.admin.signOut(i,e);if(t&&(!function(e){return Yr(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(yield this._removeSession(),yield Sn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(()=>{f(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){this._emitInitialSession(t)}))})})(),{data:{subscription:s}}}_emitInitialSession(e){return f(this,null,function*(){return yield this._useSession(t=>f(this,null,function*(){var s,r;try{const{data:{session:r},error:n}=t;if(n)throw n;yield null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(n){yield null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",n)}}))})}resetPasswordForEmail(e){return f(this,arguments,function*(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=yield An(this.storage,this.storageKey,!0));try{return yield Un(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(n){if(Yr(n))return{data:null,error:n};throw n}})}getUserIdentities(){return f(this,null,function*(){var e;try{const{data:t,error:s}=yield this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}linkIdentity(e){return f(this,null,function*(){var t;try{const{data:s,error:r}=yield this._useSession(t=>f(this,null,function*(){var s,r,n,i,o;const{data:a,error:l}=t;if(l)throw l;const c=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return yield Un(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(i=a.session)||void 0===i?void 0:i.access_token)&&void 0!==o?o:void 0})}));if(r)throw r;return xn()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(Yr(s))return{data:{provider:e.provider,url:null},error:s};throw s}})}unlinkIdentity(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var s,r;const{data:n,error:i}=t;if(i)throw i;return yield Un(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=n.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}_refreshAccessToken(e){return f(this,null,function*(){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return yield function(e,t){return new Promise((s,r)=>{(()=>{f(this,null,function*(){for(let i=0;i<1/0;i++)try{const r=yield e(i);if(!t(i,null,r))return void s(r)}catch(n){if(!t(i,n))return void r(n)}})})()})}(s=>f(this,null,function*(){return s>0&&(yield function(e){return f(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),e)})})}(200*Math.pow(2,s-1))),this._debug(t,"refreshing attempt",s),yield Un(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Mn})}),(e,t)=>{const r=200*Math.pow(2,e);return t&&an(t)&&Date.now()+r-s<Fr})}catch(s){if(this._debug(t,"error",s),Yr(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}})}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,t){return f(this,null,function*(){const s=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),xn()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}})}_recoverAndRefresh(){return f(this,null,function*(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=yield Nn(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&(yield this._removeSession()));const r=1e3*(null!==(e=s.expires_at)&&void 0!==e?e:1/0)-Date.now()<Hr;if(this._debug(t,`session has${r?"":" not"} expired with margin of 90000s`),r){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=yield this._callRefreshToken(s.refresh_token);e&&(an(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),yield this._removeSession()))}}else yield this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return void this._debug(t,"error",s)}finally{this._debug(t,"end")}})}_callRefreshToken(e){return f(this,null,function*(){var t,s;if(!e)throw new en;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Tn;const{data:t,error:s}=yield this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new en;yield this._saveSession(t.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(n){if(this._debug(r,"error",n),Yr(n)){const e={session:null,error:n};return an(n)||(yield this._removeSession()),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(n),n}finally{this.refreshingDeferred=null,this._debug(r,"end")}})}_notifyAllSubscribers(e,t,s=!0){return f(this,null,function*(){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],n=Array.from(this.stateChangeEmitters.values()).map(s=>f(this,null,function*(){try{yield s.callback(e,t)}catch(n){r.push(n)}}));if(yield Promise.all(n),r.length>0){for(let e=0;e<r.length;e+=1);throw r[0]}}finally{this._debug(r,"end")}})}_saveSession(e){return f(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,yield kn(this.storage,this.storageKey,e)})}_removeSession(){return f(this,null,function*(){this._debug("#_removeSession()"),yield Sn(this.storage,this.storageKey),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&xn()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}_startAutoRefresh(){return f(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Fr);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(()=>f(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return f(this,null,function*(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return f(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return f(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return f(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>f(this,null,function*(){try{const t=Date.now();try{return yield this._useSession(e=>f(this,null,function*(){const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-t)/Fr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&(yield this._callRefreshToken(s.refresh_token))}))}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof Yn))throw e;this._debug("auto refresh token tick lock not available")}})}_handleVisibilityChange(){return f(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!xn()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>f(this,null,function*(){return yield this._onVisibilityChanged(!1)}),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){}})}_onVisibilityChanged(e){return f(this,null,function*(){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>f(this,null,function*(){"visible"===document.visibilityState?yield this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,t,s){return f(this,null,function*(){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=yield An(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`})}_unenroll(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var s;const{data:r,error:n}=t;return n?{data:null,error:n}:yield Un(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}_enroll(e){return f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var s,r;const{data:n,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:a,error:l}=yield Un(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:null===(s=null==n?void 0:n.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==a?void 0:a.totp)||void 0===r?void 0:r.qr_code)&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}))}catch(t){if(Yr(t))return{data:null,error:t};throw t}})}_verify(e){return f(this,null,function*(){return this._acquireLock(-1,()=>f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var s;const{data:r,error:n}=t;if(n)return{data:null,error:n};const{data:i,error:o}=yield Un(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return o?{data:null,error:o}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})}))}catch(t){if(Yr(t))return{data:null,error:t};throw t}}))})}_challenge(e){return f(this,null,function*(){return this._acquireLock(-1,()=>f(this,null,function*(){try{return yield this._useSession(t=>f(this,null,function*(){var s;const{data:r,error:n}=t;return n?{data:null,error:n}:yield Un(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Yr(t))return{data:null,error:t};throw t}}))})}_challengeAndVerify(e){return f(this,null,function*(){const{data:t,error:s}=yield this._challenge({factorId:e.factorId});return s?{data:null,error:s}:yield this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})})}_listFactors(){return f(this,null,function*(){const{data:{user:e},error:t}=yield this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter(e=>"totp"===e.factor_type&&"verified"===e.status),n=s.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:s,totp:r,phone:n},error:null}})}_getAuthenticatorAssuranceLevel(){return f(this,null,function*(){return this._acquireLock(-1,()=>f(this,null,function*(){return yield this._useSession(e=>f(this,null,function*(){var t,s;const{data:{session:r},error:n}=e;if(n)return{data:null,error:n};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=En(r.access_token);let o=null;i.aal&&(o=i.aal);let a=o;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==s?s:[]).length>0&&(a="aal2");return{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:i.amr||[]},error:null}}))}))})}fetchJwk(e){return f(this,arguments,function*(e,t={keys:[]}){let s=t.keys.find(t=>t.kid===e);if(s)return s;if(s=this.jwks.keys.find(t=>t.kid===e),s&&this.jwks_cached_at+6e5>Date.now())return s;const{data:r,error:n}=yield Un(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(n)throw n;if(!r.keys||0===r.keys.length)throw new cn("JWKS is empty");if(this.jwks=r,this.jwks_cached_at=Date.now(),s=r.keys.find(t=>t.kid===e),!s)throw new cn("No matching signing key found in JWKS");return s})}getClaims(e){return f(this,arguments,function*(e,t={keys:[]}){try{let s=e;if(!s){const{data:e,error:t}=yield this.getSession();if(t||!e.session)return{data:null,error:t};s=e.session.access_token}const{header:r,payload:n,signature:i,raw:{header:o,payload:a}}=En(s);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(n.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=yield this.getUser(s);if(e)throw e;return{data:{claims:n,header:r,signature:i},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=yield this.fetchJwk(r.kid,t),d=yield crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!(yield crypto.subtle.verify(l,d,i,bn(`${o}.${a}`))))throw new cn("Invalid JWT signature");return{data:{claims:n,header:r,signature:i},error:null}}catch(s){if(Yr(s))return{data:null,error:s};throw s}})}}ti.nextInstanceID=0;const si=ti;class ri extends si{constructor(e){super(e)}}var ni=function(e,t,s,r){return new(s||(s=Promise))(function(n,i){function o(e){try{l(r.next(e))}catch(t){i(t)}}function a(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(o,a)}l((r=r.apply(e,t||[])).next())})};class ii{constructor(e,t,s){var r,n,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=(a=e).endsWith("/")?a:a+"/";var a;const l=new URL(o);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d=function(e,t){var s,r;const{db:n,auth:i,realtime:o,global:a}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},d),o),global:Object.assign(Object.assign(Object.assign({},u),a),{headers:Object.assign(Object.assign({},null!==(s=null==u?void 0:u.headers)&&void 0!==s?s:{}),null!==(r=null==a?void 0:a.headers)&&void 0!==r?r:{})}),accessToken:()=>Br(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=s?s:{},{db:Lr,realtime:Ur,auth:Object.assign(Object.assign({},Dr),{storageKey:c}),global:Rr});this.storageKey=null!==(r=d.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(n=d.global.headers)&&void 0!==n?n:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=d.auth)&&void 0!==i?i:{},this.headers,d.global.fetch),this.fetch=zr(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new ws(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),d.accessToken||this._listenForAuthEvents()}get functions(){return new Pt(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new Ir(this.storageUrl.href,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ni(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:n,flowType:i,lock:o,debug:a},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ri({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),l),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:i,lock:o,debug:a,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new dr(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const oi=new ii("https://btmstwhpsvjqxuaxqzyp.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJ0bXN0d2hwc3ZqcXh1YXhxenlwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1MDY0MzM0MCwiZXhwIjoyMDY2MjE5MzQwfQ.niYp9-a5V8E83-Z6mBT2sVVLLwGJa3yik6uUlO8OPIo",ai);var ai;const li=m.createContext(),ci=()=>m.useContext(li),di=({children:e})=>{const[t,s]=m.useState(null),[r,n]=m.useState(!0),[i,o]=m.useState(null),[a,l]=m.useState(null),c=m.useCallback(e=>f(void 0,null,function*(){if(e)try{const{data:t,error:s}=yield oi.from("profiles").select("*").eq("id",e).single();l(s?null:t)}catch(t){l(null)}}),[]),d=m.useCallback(e=>f(void 0,null,function*(){if(!(null==t?void 0:t.id))throw new Error("No authenticated user");try{const{data:s,error:r}=yield oi.from("profiles").update({first_name:e.firstName,last_name:e.lastName,full_name:`${e.firstName} ${e.lastName}`.trim(),email:e.email,phone:e.phone,location:e.location,bio:e.bio,updated_at:(new Date).toISOString()}).eq("id",t.id).select().single();if(r)throw r;return l(s),{success:!0,data:s}}catch(s){return{success:!1,error:s.message}}}),[null==t?void 0:t.id]);m.useEffect(()=>{var e;let t;f(void 0,null,function*(){try{n(!0);const e=yield f(void 0,null,function*(){const{data:e,error:t}=yield oi.auth.getUser();if(t)throw t;return e.user});s(e),e&&(yield c(e.id)),n(!1)}catch(e){s(null),l(null),n(!1)}});const{data:r}=(i=(e,t)=>{(null==t?void 0:t.user)?(s(t.user),c(t.user.id)):(s(null),l(null))},oi.auth.onAuthStateChange((e,t)=>{i(e,t)}));var i;return t=null==(e=null==r?void 0:r.subscription)?void 0:e.unsubscribe,()=>{t&&t()}},[c]);const u=m.useCallback((e,t)=>f(void 0,null,function*(){n(!0),o(null);try{const r=yield((e,t)=>f(void 0,null,function*(){const{data:s,error:r}=yield oi.auth.signInWithPassword({email:e,password:t});if(r)throw r;return s.user}))(e,t);return s(r),yield c(r.id),r}catch(r){throw o(r.message),r}finally{n(!1)}}),[c]),h=m.useCallback((e,t,r="")=>f(void 0,null,function*(){n(!0),o(null);try{const n=yield((e,t,...s)=>f(void 0,[e,t,...s],function*(e,t,s={}){const{data:r,error:n}=yield oi.auth.signUp({email:e,password:t,options:{data:s}});if(n)throw n;return r.user}))(e,t,{full_name:r});return s(n),yield c(n.id),n}catch(i){throw o(i.message),i}finally{n(!1)}}),[c]),p=m.useCallback(()=>f(void 0,null,function*(){n(!0),o(null);try{yield f(void 0,null,function*(){const{error:e}=yield oi.auth.signOut();if(e)throw e}),s(null),l(null)}catch(e){o(e.message)}finally{n(!1)}}),[]),g=m.useCallback(()=>(null==a?void 0:a.first_name)&&(null==a?void 0:a.last_name)?`${a.first_name} ${a.last_name}`:(null==a?void 0:a.full_name)?a.full_name:(null==t?void 0:t.email)?t.email.split("@")[0]:"User",[a,t]),y=m.useCallback(()=>{if((null==a?void 0:a.first_name)&&(null==a?void 0:a.last_name))return`${a.first_name.charAt(0)}${a.last_name.charAt(0)}`.toUpperCase();if(null==a?void 0:a.full_name){const e=a.full_name.split(" ");return e.length>=2?`${e[0].charAt(0)}${e[1].charAt(0)}`.toUpperCase():e[0].charAt(0).toUpperCase()}return(null==t?void 0:t.email)?t.email.charAt(0).toUpperCase():"U"},[a,t]);return we.jsx(li.Provider,{value:{user:t,profile:a,loading:r,error:i,login:u,signup:h,logout:p,updateProfile:d,getUserDisplayName:g,getUserInitials:y,isAuthenticated:!!t},children:e})},ui=({onClose:e})=>{const{user:t,profile:s,updateProfile:r,logout:n,getUserDisplayName:i,getUserInitials:o}=ci(),[a,l]=m.useState(!1),[u,h]=m.useState(!1),[p,g]=m.useState({firstName:"",lastName:"",email:"",phone:"",location:"",bio:""}),[y,b]=m.useState(!1),[v,x]=m.useState("");m.useEffect(()=>{s?g({firstName:s.first_name||"",lastName:s.last_name||"",email:s.email||(null==t?void 0:t.email)||"",phone:s.phone||"",location:s.location||"",bio:s.bio||""}):t&&g({firstName:"",lastName:"",email:t.email||"",phone:"",location:"",bio:""})},[s,t]);const w=e=>{g(d(c({},p),{[e.target.name]:e.target.value}))};return t?we.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:we.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[we.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-600 text-white p-6 rounded-t-2xl",children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{className:"flex items-center space-x-3",children:[we.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:we.jsx(P,{className:"h-6 w-6"})}),we.jsxs("div",{children:[we.jsx("h2",{className:"text-xl font-bold",children:"User Profile"}),we.jsx("p",{className:"text-blue-100 text-sm",children:"Manage your account information"})]})]}),we.jsx("button",{onClick:e,className:"text-white hover:text-blue-200 transition-colors p-2",children:we.jsx(I,{className:"h-5 w-5"})})]})}),we.jsxs("div",{className:"p-6",children:[y&&we.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center space-x-3",children:[we.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:we.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),we.jsx("span",{className:"text-green-700",children:"Profile updated successfully!"})]}),v&&we.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-3",children:[we.jsx("div",{className:"w-5 h-5 bg-red-500 rounded-full flex items-center justify-center",children:we.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),we.jsx("span",{className:"text-red-700",children:v})]}),we.jsxs("div",{className:"text-center mb-8",children:[we.jsxs("div",{className:"relative inline-block",children:[we.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white text-2xl font-bold mb-4",children:o()}),we.jsx("button",{className:"absolute bottom-0 right-0 w-8 h-8 bg-white border-2 border-gray-200 rounded-full flex items-center justify-center hover:bg-gray-50 transition-colors",children:we.jsx($,{className:"h-4 w-4 text-gray-600"})})]}),we.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:i()}),we.jsx("p",{className:"text-gray-600",children:null==t?void 0:t.email}),!s&&we.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"âš ï¸ Profile data loading..."})]}),we.jsxs("form",{onSubmit:e=>f(void 0,null,function*(){e.preventDefault(),h(!0),x(""),b(!1);try{const e=yield r(p);e.success?(b(!0),l(!1),setTimeout(()=>b(!1),3e3)):x(e.error)}catch(t){x(t.message||"Failed to update profile")}h(!1)}),className:"space-y-6",children:[we.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name"}),we.jsx("input",{type:"text",name:"firstName",value:p.firstName,onChange:w,disabled:!a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]}),we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name"}),we.jsx("input",{type:"text",name:"lastName",value:p.lastName,onChange:w,disabled:!a,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]}),we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),we.jsxs("div",{className:"relative",children:[we.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:we.jsx(R,{className:"h-5 w-5 text-gray-400"})}),we.jsx("input",{type:"email",name:"email",value:p.email,onChange:w,disabled:!a,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500"})]})]}),we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),we.jsxs("div",{className:"relative",children:[we.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:we.jsx(L,{className:"h-5 w-5 text-gray-400"})}),we.jsx("input",{type:"tel",name:"phone",value:p.phone,onChange:w,disabled:!a,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your phone number"})]})]}),we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),we.jsxs("div",{className:"relative",children:[we.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:we.jsx(D,{className:"h-5 w-5 text-gray-400"})}),we.jsx("input",{type:"text",name:"location",value:p.location,onChange:w,disabled:!a,className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Enter your location"})]})]}),we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),we.jsx("textarea",{name:"bio",value:p.bio,onChange:w,disabled:!a,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:bg-gray-50 disabled:text-gray-500",placeholder:"Tell us about yourself..."})]}),we.jsxs("div",{className:"flex items-center justify-between pt-6 border-t border-gray-200",children:[we.jsx("div",{className:"flex space-x-3",children:a?we.jsxs(we.Fragment,{children:[we.jsxs("button",{type:"submit",disabled:u,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:[we.jsx(M,{className:"h-4 w-4"}),we.jsx("span",{children:u?"Saving...":"Save Changes"})]}),we.jsx("button",{type:"button",onClick:()=>{s&&g({firstName:s.first_name||"",lastName:s.last_name||"",email:s.email||(null==t?void 0:t.email)||"",phone:s.phone||"",location:s.location||"",bio:s.bio||""}),l(!1),x("")},className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Cancel"})]}):we.jsxs("button",{type:"button",onClick:()=>l(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[we.jsx(U,{className:"h-4 w-4"}),we.jsx("span",{children:"Edit Profile"})]})}),we.jsxs("button",{type:"button",onClick:()=>{n(),e()},className:"flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:[we.jsx(z,{className:"h-4 w-4"}),we.jsx("span",{children:"Sign Out"})]})]})]})]})]})}):we.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:we.jsx("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6",children:we.jsxs("div",{className:"text-center",children:[we.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:we.jsx(P,{className:"h-8 w-8 text-red-600"})}),we.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Not Authenticated"}),we.jsx("p",{className:"text-gray-600 mb-4",children:"Please sign in to view your profile."}),we.jsx("button",{onClick:e,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors",children:"Close"})]})})})};const hi=new class{constructor(){this.interactionBuffer=[],this.maxBufferSize=50,this.learningEnabled=!0}trackInteraction(e){return f(this,null,function*(){if(!this.learningEnabled)return;const t=d(c({},e),{timestamp:(new Date).toISOString(),session_id:this.getSessionId(),user_agent:navigator.userAgent,url:window.location.href,performance_metrics:this.getPerformanceMetrics()});this.interactionBuffer.push(t),yield this.saveInteraction(t),this.interactionBuffer.length>=this.maxBufferSize&&(yield this.processLearningBatch())})}trackAICommand(e,t,s=!0,r=null){return f(this,null,function*(){yield this.trackInteraction({type:"ai_command",command:e,response:t,success:s,user_feedback:r,response_time:this.getResponseTime(),command_complexity:this.analyzeComplexity(e),response_quality:this.analyzeResponseQuality(t)})})}trackError(e){return f(this,arguments,function*(e,t={}){yield this.trackInteraction({type:"error",error_message:e.message,error_stack:e.stack,error_type:e.name,context:t,severity:this.analyzeErrorSeverity(e),recovery_action:this.suggestRecoveryAction(e)})})}trackCorrection(e,t,s){return f(this,null,function*(){yield this.trackInteraction({type:"correction",original_response:e,corrected_response:t,correction_type:s,improvement_score:this.calculateImprovementScore(e,t)})})}trackUserPreference(e,t){return f(this,arguments,function*(e,t,s={}){yield this.trackInteraction({type:"preference",preference_key:e,preference_value:t,context:s,timestamp:(new Date).toISOString()})})}learnFromSuccess(e,t,s){return f(this,null,function*(){const r={command_pattern:this.extractPattern(e),response_template:this.extractTemplate(t),success_factors:this.analyzeSuccessFactors(e,t),user_satisfaction:s,context:this.getCurrentContext()};yield this.saveLearningData(r)})}learnFromFailure(e,t,s){return f(this,null,function*(){const r={command_pattern:this.extractPattern(e),failed_response:t,user_correction:s,failure_reasons:this.analyzeFailureReasons(e,t),improvement_suggestions:this.generateImprovementSuggestions(e,s)};yield this.saveFailureData(r)})}getImprovedResponse(e){return f(this,arguments,function*(e,t={}){const s=yield this.getRelevantLearningData(e),r=yield this.getUserPreferences(),n=yield this.getCommonPatterns();return this.generateImprovedResponse(e,s,r,n,t)})}analyzeComplexity(e){const t=e.length,s=e.split(" ").length;let r=0;return r+=t>100?3:t>50?2:1,r+=s>10?2:s>5?1:0,r+=/[^a-zA-Z0-9\s]/.test(e)?1:0,r+=/\d/.test(e)?1:0,r+=/https?:\/\//.test(e)?2:0,r+=/\S+@\S+\.\S+/.test(e)?1:0,Math.min(r,10)}analyzeResponseQuality(e){const t=e.length;let s=0;return s+=t>200?3:t>100?2:1,s+=/```[\s\S]*```/.test(e)?2:0,s+=/\[.*?\]\(.*?\)/.test(e)?1:0,s+=/^\s*[-*+]\s/.test(e)?1:0,s+=/^#{1,6}\s/.test(e)?1:0,s+=2*this.assessCompleteness(e),s+=2*this.assessClarity(e),Math.min(s,10)}assessCompleteness(e){let t=0;return e.includes("```")&&(t+=.3),(e.includes("##")||e.includes("###"))&&(t+=.2),(e.includes("- ")||e.includes("* "))&&(t+=.2),(e.includes("**")||e.includes("__"))&&(t+=.1),e.length>500&&(t+=.2),Math.min(t,1)}assessClarity(e){let t=0;const s=e.split(/[.!?]+/).filter(e=>e.trim().length>0);return s.reduce((e,t)=>e+t.length,0)/s.length<100&&(t+=.3),(e.includes("Here")||e.includes("Let me"))&&(t+=.2),(e.includes("First")||e.includes("Next")||e.includes("Finally"))&&(t+=.2),(e.includes("example")||e.includes("Example"))&&(t+=.2),(e.includes("**")||e.includes("__"))&&(t+=.1),Math.min(t,1)}extractPattern(e){const t={create:/create|make|build|generate/i,update:/update|modify|change|edit/i,delete:/delete|remove|drop/i,show:/show|display|view|list/i,help:/help|assist|support/i,explain:/explain|describe|tell/i,fix:/fix|repair|resolve/i,improve:/improve|enhance|optimize/i};for(const[s,r]of Object.entries(t))if(r.test(e))return s;return"general"}extractTemplate(e){const t={code_block:/```[\s\S]*```/,list:/^\s*[-*+]\s/m,numbered_list:/^\s*\d+\.\s/m,headers:/^#{1,6}\s/m,bold:/\*\*.*?\*\*/,italic:/\*.*?\*/,links:/\[.*?\]\(.*?\)/,tables:/\|.*\|/},s=[];for(const[r,n]of Object.entries(t))n.test(e)&&s.push(r);return s}analyzeErrorSeverity(e){return e.message.includes("network")||e.message.includes("fetch")||e.message.includes("auth")||e.message.includes("permission")?"high":e.message.includes("validation")||e.message.includes("format")||e.message.includes("not found")||e.message.includes("404")?"medium":"low"}suggestRecoveryAction(e){const t="retry_connection",s="reauthenticate",r="validate_input",n="check_resource",i="check_permissions",o="show_error_message";return e.message.includes("network")?t:e.message.includes("auth")?s:e.message.includes("validation")?r:e.message.includes("not found")?n:e.message.includes("permission")?i:o}calculateImprovementScore(e,t){const s=this.analyzeResponseQuality(e),r=this.analyzeResponseQuality(t);return Math.max(0,r-s)}getCurrentContext(){return{url:window.location.href,pathname:window.location.pathname,search:window.location.search,timestamp:(new Date).toISOString(),user_agent:navigator.userAgent,screen_size:`${window.screen.width}x${window.screen.height}`,viewport:`${window.innerWidth}x${window.innerHeight}`}}getSessionId(){let e=sessionStorage.getItem("ai_learning_session_id");return e||(e="session_"+Date.now()+"_"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("ai_learning_session_id",e)),e}getPerformanceMetrics(){if(window.performance&&window.performance.timing){const e=window.performance.timing;return{page_load_time:e.loadEventEnd-e.navigationStart,dom_ready_time:e.domContentLoadedEventEnd-e.navigationStart,first_paint:e.responseEnd-e.navigationStart}}return{}}getResponseTime(){return Date.now()-(this.lastCommandTime||Date.now())}saveInteraction(e){return f(this,null,function*(){try{const{error:t}=yield oi.from("ai_interactions").insert([e])}catch(t){}})}saveLearningData(e){return f(this,null,function*(){try{const{error:t}=yield oi.from("ai_learning_data").insert([e])}catch(t){}})}saveFailureData(e){return f(this,null,function*(){try{const{error:t}=yield oi.from("ai_failure_data").insert([e])}catch(t){}})}getRelevantLearningData(e){return f(this,null,function*(){try{const t=this.extractPattern(e),{data:s,error:r}=yield oi.from("ai_learning_data").select("*").eq("command_pattern",t).order("created_at",{ascending:!1}).limit(10);return r?[]:s||[]}catch(t){return[]}})}getUserPreferences(){return f(this,null,function*(){try{const{data:e,error:t}=yield oi.from("ai_interactions").select("preference_key, preference_value").eq("type","preference").order("timestamp",{ascending:!1}).limit(50);if(t)return{};const s={};return(e||[]).forEach(e=>{s[e.preference_key]=e.preference_value}),s}catch(e){return{}}})}getCommonPatterns(){return f(this,null,function*(){try{const{data:e,error:t}=yield oi.from("ai_interactions").select("command_pattern, COUNT(*) as count").eq("type","ai_command").group("command_pattern").order("count",{ascending:!1}).limit(10);return t?[]:e||[]}catch(e){return[]}})}processLearningBatch(){return f(this,null,function*(){if(0===this.interactionBuffer.length)return;const e=this.interactionBuffer.splice(0,this.maxBufferSize),t=this.analyzeBatchPatterns(e);yield this.updateLearningModels(t),this.interactionBuffer=[]})}analyzeBatchPatterns(e){const t={command_types:{},error_types:{},success_rates:{},user_preferences:{},response_qualities:[]};return e.forEach(e=>{"ai_command"===e.type?(t.command_types[e.command_pattern]=(t.command_types[e.command_pattern]||0)+1,t.response_qualities.push(e.response_quality),e.success&&(t.success_rates[e.command_pattern]=(t.success_rates[e.command_pattern]||0)+1)):"error"===e.type?t.error_types[e.error_type]=(t.error_types[e.error_type]||0)+1:"preference"===e.type&&(t.user_preferences[e.preference_key]=e.preference_value)}),t}updateLearningModels(e){return f(this,null,function*(){try{const{error:t}=yield oi.from("ai_learning_models").upsert([{model_type:"pattern_analysis",patterns:e,updated_at:(new Date).toISOString()}],{onConflict:"model_type"})}catch(t){}})}generateImprovedResponse(e,t,s,r,n){const i=this.extractPattern(e),o=t.find(e=>e.command_pattern===i);let a=e;return o&&(a+="\n\nBased on previous successful interactions, here's an improved approach:",a+="\n\n**Key Success Factors:**",o.success_factors.forEach(e=>{a+=`\n- ${e}`})),s.response_style&&(a+=`\n\n**Response Style:** ${s.response_style}`),r.length>0&&(a+="\n\n**Common Patterns:**",r.slice(0,3).forEach(e=>{a+=`\n- ${e.command_pattern}: ${e.count} times`})),a}setLearningEnabled(e){this.learningEnabled=e,localStorage.setItem("ai_learning_enabled",e.toString())}isLearningEnabled(){return this.learningEnabled}getLearningStats(){return f(this,null,function*(){var e,t;try{const{data:s,error:r}=yield oi.from("ai_interactions").select("type, COUNT(*) as count").group("type"),{data:n,error:i}=yield oi.from("ai_learning_data").select("COUNT(*) as count"),{data:o,error:a}=yield oi.from("ai_failure_data").select("COUNT(*) as count");return{total_interactions:(null==s?void 0:s.reduce((e,t)=>e+parseInt(t.count),0))||0,interaction_types:s||[],learning_entries:(null==(e=null==n?void 0:n[0])?void 0:e.count)||0,failure_entries:(null==(t=null==o?void 0:o[0])?void 0:t.count)||0,learning_enabled:this.learningEnabled}}catch(s){return{total_interactions:0,interaction_types:[],learning_entries:0,failure_entries:0,learning_enabled:this.learningEnabled}}})}},fi=({onClose:e})=>{var t,s,r,n,i;const{user:o}=ci(),[a,l]=m.useState(null),[c,d]=m.useState(!0),[u,h]=m.useState(!0),[p,g]=m.useState("overview"),[y,b]=m.useState(""),[v,x]=m.useState(""),[w,_]=m.useState(!1);m.useEffect(()=>{j(),h(hi.isLearningEnabled())},[]);const j=()=>f(void 0,null,function*(){try{d(!0);const e=yield hi.getLearningStats();l(e)}catch(e){}finally{d(!1)}}),k=()=>{const e=!u;h(e),hi.setLearningEnabled(e)};return c?we.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:we.jsx("div",{className:"bg-white rounded-lg p-6",children:we.jsxs("div",{className:"flex items-center space-x-3",children:[we.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),we.jsx("span",{children:"Loading AI Learning Dashboard..."})]})})}):we.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:we.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-y-auto",children:[we.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 rounded-t-2xl",children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{className:"flex items-center space-x-3",children:[we.jsx("div",{className:"w-12 h-12 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:we.jsx(B,{className:"h-6 w-6"})}),we.jsxs("div",{children:[we.jsx("h2",{className:"text-xl font-bold",children:"AI Learning Dashboard"}),we.jsx("p",{className:"text-purple-100 text-sm",children:"Monitor and improve AI responses"})]})]}),we.jsxs("div",{className:"flex items-center space-x-4",children:[we.jsxs("button",{onClick:k,className:"flex items-center space-x-2 px-3 py-2 rounded-lg transition-colors "+(u?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"),children:[u?we.jsx(q,{className:"h-4 w-4"}):we.jsx(F,{className:"h-4 w-4"}),we.jsx("span",{children:u?"Learning ON":"Learning OFF"})]}),we.jsx("button",{onClick:e,className:"text-white hover:text-purple-200 transition-colors p-2",children:"âœ•"})]})]})}),we.jsxs("div",{className:"p-6",children:[we.jsx("div",{className:"flex space-x-1 mb-6 bg-gray-100 rounded-lg p-1",children:[{id:"overview",label:"Overview",icon:H},{id:"testing",label:"Testing",icon:J},{id:"analytics",label:"Analytics",icon:W},{id:"settings",label:"Settings",icon:T}].map(e=>we.jsxs("button",{onClick:()=>g(e.id),className:"flex items-center space-x-2 px-4 py-2 rounded-md transition-colors "+(p===e.id?"bg-white shadow-sm text-blue-600":"text-gray-600 hover:text-gray-900"),children:[we.jsx(e.icon,{className:"h-4 w-4"}),we.jsx("span",{children:e.label})]},e.id))}),"overview"===p&&we.jsxs("div",{className:"space-y-6",children:[we.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[we.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Interactions"}),we.jsx("p",{className:"text-2xl font-bold text-blue-900",children:(null==a?void 0:a.total_interactions)||0})]}),we.jsx(B,{className:"h-8 w-8 text-blue-600"})]})}),we.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Success Rate"}),we.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[(null==(s=null==(t=null==a?void 0:a.interaction_types)?void 0:t.find(e=>"ai_command"===e.type))?void 0:s.success_rate)||0,"%"]})]}),we.jsx(K,{className:"h-8 w-8 text-green-600"})]})}),we.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Learning Entries"}),we.jsx("p",{className:"text-2xl font-bold text-purple-900",children:(null==a?void 0:a.learning_entries)||0})]}),we.jsx(W,{className:"h-8 w-8 text-purple-600"})]})}),we.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Failures Tracked"}),we.jsx("p",{className:"text-2xl font-bold text-red-900",children:(null==a?void 0:a.failure_entries)||0})]}),we.jsx(V,{className:"h-8 w-8 text-red-600"})]})})]}),we.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[we.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recent Learning Activity"}),we.jsx("div",{className:"space-y-2",children:null==(r=null==a?void 0:a.interaction_types)?void 0:r.map((e,t)=>we.jsxs("div",{className:"flex items-center justify-between p-2 bg-white rounded",children:[we.jsx("span",{className:"font-medium",children:e.type}),we.jsxs("span",{className:"text-gray-600",children:[e.count," interactions"]})]},t))})]})]}),"testing"===p&&we.jsx("div",{className:"space-y-6",children:we.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[we.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Test AI Learning"}),we.jsx("p",{className:"text-blue-700 mb-4",children:"Try different commands to see how the AI learns and improves its responses."}),we.jsxs("div",{className:"space-y-4",children:[we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Test Command"}),we.jsxs("div",{className:"flex space-x-2",children:[we.jsx("input",{type:"text",value:y,onChange:e=>b(e.target.value),placeholder:"Enter a command to test...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),we.jsx("button",{onClick:()=>f(void 0,null,function*(){if(y.trim())try{const e=`This is a test response to: "${y}"\n\n**Learning Analysis:**\n- Command complexity: ${hi.analyzeComplexity(y)}/10\n- Pattern detected: ${hi.extractPattern(y)}\n- Suggested improvements based on learning data`;x(e),yield hi.trackAICommand(y,e,!0,"test_interaction"),yield hi.learnFromSuccess(y,e,8),yield j()}catch(e){x("Error: "+e.message),yield hi.trackError(e,{command:y})}}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Test"})]})]}),v&&we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"AI Response"}),we.jsx("div",{className:"bg-gray-100 p-4 rounded-lg",children:we.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:v})}),we.jsxs("div",{className:"mt-4 flex items-center space-x-4",children:[we.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Rate this response:"}),[1,2,3,4,5].map(e=>we.jsx("button",{onClick:()=>(e=>f(void 0,null,function*(){if(y&&v)try{yield hi.trackUserPreference("response_rating",e.toString(),{command:y,response:v}),yield j()}catch(t){}}))(e),className:"px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded transition-colors",children:e},e)),we.jsx("button",{onClick:()=>f(void 0,null,function*(){if(!y||!v)return;const e=prompt("What would be a better response?");if(e)try{yield hi.trackCorrection(v,e,"user_correction"),yield hi.learnFromFailure(y,v,e),x(e),yield j()}catch(t){}}),className:"px-3 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 transition-colors",children:"Suggest Correction"})]})]})]})]})}),"analytics"===p&&we.jsx("div",{className:"space-y-6",children:we.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[we.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Learning Analytics"}),we.jsx("p",{className:"text-green-700 mb-4",children:"Detailed insights into AI learning patterns and performance."}),we.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[we.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[we.jsx("h4",{className:"font-medium mb-2",children:"Command Patterns"}),we.jsx("div",{className:"space-y-2",children:null==(n=null==a?void 0:a.interaction_types)?void 0:n.filter(e=>"ai_command"===e.type).map((e,t)=>we.jsxs("div",{className:"flex justify-between",children:[we.jsx("span",{children:e.type}),we.jsx("span",{className:"font-medium",children:e.count})]},t))})]}),we.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[we.jsx("h4",{className:"font-medium mb-2",children:"Error Types"}),we.jsx("div",{className:"space-y-2",children:null==(i=null==a?void 0:a.interaction_types)?void 0:i.filter(e=>"error"===e.type).map((e,t)=>we.jsxs("div",{className:"flex justify-between",children:[we.jsx("span",{children:e.type}),we.jsx("span",{className:"font-medium",children:e.count})]},t))})]})]})]})}),"settings"===p&&we.jsx("div",{className:"space-y-6",children:we.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[we.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Learning Settings"}),we.jsxs("div",{className:"space-y-4",children:[we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium",children:"Learning Mode"}),we.jsx("p",{className:"text-sm text-gray-600",children:"Enable AI to learn from interactions"})]}),we.jsx("button",{onClick:k,className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(u?"bg-blue-600":"bg-gray-300"),children:we.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(u?"translate-x-6":"translate-x-1")})})]}),we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium",children:"Advanced Analytics"}),we.jsx("p",{className:"text-sm text-gray-600",children:"Show detailed learning metrics"})]}),we.jsx("button",{onClick:()=>_(!w),className:"relative inline-flex h-6 w-11 items-center rounded-full transition-colors "+(w?"bg-blue-600":"bg-gray-300"),children:we.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition-transform "+(w?"translate-x-6":"translate-x-1")})})]}),w&&we.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[we.jsx("h4",{className:"font-medium mb-2",children:"Advanced Settings"}),we.jsxs("div",{className:"space-y-2 text-sm",children:[we.jsxs("p",{children:["Buffer Size: ",hi.maxBufferSize]}),we.jsxs("p",{children:["Session ID: ",hi.getSessionId()]}),we.jsxs("p",{children:["Learning Enabled: ",hi.isLearningEnabled()?"Yes":"No"]})]})]})]})]})})]})]})})};const mi=new class{constructor(){this.templates={resume:{layouts:["classic","modern","creative","professional","minimal","executive"],sections:["header","summary","experience","education","skills","projects","certifications"],dataTypes:["personal","professional","academic","creative"]},coverLetter:{layouts:["classic","modern","professional","creative","minimal"],sections:["header","greeting","introduction","body","closing","signature"],dataTypes:["job_application","internship","freelance","academic"]},portfolio:{layouts:["showcase","timeline","grid","minimal","creative"],sections:["hero","about","projects","skills","contact","blog"],dataTypes:["developer","designer","writer","photographer","consultant"]},cv:{layouts:["academic","research","professional","international"],sections:["personal","education","research","publications","conferences","awards"],dataTypes:["phd","postdoc","researcher","professor"]}},this.commandPatterns={create:/create|make|build|generate|new/i,update:/update|modify|change|edit|revise/i,delete:/delete|remove|drop|clear/i,show:/show|display|view|list|see/i,help:/help|assist|support|guide/i,explain:/explain|describe|tell|what|how/i,fix:/fix|repair|resolve|correct/i,improve:/improve|enhance|optimize|better/i,template:/template|layout|design|style/i,format:/format|structure|organize/i},this.contentTypes={resume:/resume|cv|curriculum vitae|professional summary/i,coverLetter:/cover letter|application letter|motivation letter|letter of intent/i,portfolio:/portfolio|showcase|work samples|projects/i,cv:/academic cv|research cv|scholarly cv/i}}analyzeCommand(e){return f(this,null,function*(){const t=this.detectContentType(e),s=this.suggestLayout(e,t),r=this.suggestSections(e,t);return{contentType:t,layout:s,sections:r,template:yield this.getTemplate(t,s),suggestions:this.generateSuggestions(t,s,r)}})}detectContentType(e){for(const[t,s]of Object.entries(this.contentTypes))if(s.test(e))return t;return"resume"}suggestLayout(e,t){return/modern|contemporary/i.test(e)?"modern":/creative|artistic/i.test(e)?"creative":/professional|business/i.test(e)?"professional":/minimal|simple/i.test(e)?"minimal":/executive|senior/i.test(e)?"executive":"professional"}suggestSections(e,t){const s={resume:["header","summary","experience","education","skills"],coverLetter:["header","greeting","introduction","body","closing","signature"],portfolio:["hero","about","projects","skills","contact"],cv:["personal","education","research","publications","conferences"]};return s[t]||s.resume}getTemplate(e,t){return f(this,null,function*(){try{const{data:s,error:r}=yield oi.from("ai_templates").select("*").eq("content_type",e).eq("layout",t).single();return s||this.getDefaultTemplate(e,t)}catch(s){return this.getDefaultTemplate(e,t)}})}getDefaultTemplate(e,t){return{name:`${t} ${e}`,layout:t,sections:this.suggestSections("",e),style:"standard"}}generateTemplateData(e,t){return f(this,null,function*(){return{metadata:t,content:this.generateContent(t),styling:this.generateStyling(t)}})}generateContent(e){const{contentType:t,sections:s}=e;return"resume"===t?{header:{name:"Your Name",title:"Professional Title",email:"your.email@example.com",phone:"+1 (555) 123-4567"},summary:{text:"Professional summary text"},experience:[{title:"Job Title",company:"Company Name",duration:"2020 - Present",description:"Job description"}]}:{}}generateStyling(e){const{layout:t}=e,s={professional:{colors:["#2c3e50","#34495e","#ecf0f1"],fonts:["Arial","Helvetica","sans-serif"]},modern:{colors:["#3498db","#2980b9","#f8f9fa"],fonts:["Roboto","Open Sans","sans-serif"]},creative:{colors:["#e74c3c","#f39c12","#9b59b6"],fonts:["Playfair Display","Lato","serif"]}};return s[t]||s.professional}generateSuggestions(e,t,s){return[{type:"template",message:`Using ${t} template for ${e}`,priority:"high"}]}saveTemplate(e){return f(this,null,function*(){try{const{data:t,error:s}=yield oi.from("ai_templates").upsert([e],{onConflict:"id"});return!s}catch(t){return!1}})}getAllTemplates(){return f(this,null,function*(){try{const{data:e,error:t}=yield oi.from("ai_templates").select("*").order("content_type",{ascending:!0});return t?[]:e||[]}catch(e){return[]}})}getTemplatesByType(e){return f(this,null,function*(){try{const{data:t,error:s}=yield oi.from("ai_templates").select("*").eq("content_type",e).order("name",{ascending:!0});return s?[]:t||[]}catch(t){return[]}})}},pi=()=>{var e;const[t,s]=m.useState([]),[r,n]=m.useState([]),[i,o]=m.useState(null),[a,l]=m.useState(""),[c,d]=m.useState(null),[u,h]=m.useState(!1),[p,g]=m.useState({});m.useEffect(()=>{y(),b(),v()},[]);const y=()=>f(void 0,null,function*(){try{const{data:e,error:t}=yield oi.from("ai_templates").select("*").order("content_type",{ascending:!0});if(t)throw t;s(e||[])}catch(e){}}),b=()=>f(void 0,null,function*(){try{const{data:e,error:t}=yield oi.from("template_layouts").select("*").eq("is_active",!0).order("name",{ascending:!0});if(t)throw t;n(e||[])}catch(e){}}),v=()=>f(void 0,null,function*(){try{const{data:e,error:t}=yield oi.rpc("get_template_insights");if(t)throw t;g(e||{})}catch(e){}}),x=e=>({resume:"bg-blue-100 text-blue-800",coverLetter:"bg-green-100 text-green-800",portfolio:"bg-purple-100 text-purple-800",cv:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800");return we.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:we.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[we.jsxs("div",{className:"mb-8",children:[we.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Template Dashboard"}),we.jsx("p",{className:"mt-2 text-gray-600",children:"Manage and test AI-generated templates based on user commands"})]}),we.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Total Templates"}),we.jsx("p",{className:"text-3xl font-bold text-blue-600",children:p.total_templates||0})]}),we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Total Usage"}),we.jsx("p",{className:"text-3xl font-bold text-green-600",children:p.total_usage||0})]}),we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Success Rate"}),we.jsx("p",{className:"text-3xl font-bold text-purple-600",children:p.avg_success_rate?`${(100*p.avg_success_rate).toFixed(1)}%`:"0%"})]}),we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Popular Type"}),we.jsx("p",{className:"text-3xl font-bold text-orange-600 capitalize",children:p.most_popular_content_type||"N/A"})]})]}),we.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[we.jsx("div",{className:"lg:col-span-2",children:we.jsxs("div",{className:"bg-white rounded-lg shadow",children:[we.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:we.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Available Templates"})}),we.jsx("div",{className:"divide-y divide-gray-200",children:t.map(e=>{return we.jsx("div",{className:"p-6 cursor-pointer hover:bg-gray-50 transition-colors "+((null==i?void 0:i.id)===e.id?"bg-blue-50":""),onClick:()=>o(e),children:we.jsxs("div",{className:"flex items-center justify-between",children:[we.jsxs("div",{children:[we.jsx("h3",{className:"text-lg font-medium text-gray-900",children:e.name}),we.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),we.jsxs("div",{className:"flex gap-2 mt-2",children:[we.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x(e.content_type)}`,children:e.content_type}),we.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${t=e.layout,{professional:"bg-indigo-100 text-indigo-800",modern:"bg-cyan-100 text-cyan-800",creative:"bg-pink-100 text-pink-800",minimal:"bg-gray-100 text-gray-800",executive:"bg-yellow-100 text-yellow-800"}[t]||"bg-gray-100 text-gray-800"}`,children:e.layout})]})]}),we.jsxs("div",{className:"text-right",children:[we.jsxs("p",{className:"text-sm text-gray-500",children:["Usage: ",e.usage_count||0]}),we.jsxs("p",{className:"text-sm text-gray-500",children:["Success: ",e.success_rate?`${(100*e.success_rate).toFixed(1)}%`:"0%"]})]})]})},e.id);var t})})]})}),we.jsxs("div",{className:"space-y-6",children:[we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Test Template Analysis"}),we.jsxs("div",{className:"space-y-4",children:[we.jsxs("div",{children:[we.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Enter Command"}),we.jsx("textarea",{value:a,onChange:e=>l(e.target.value),placeholder:"e.g., Create a modern professional resume for a software developer",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),we.jsx("button",{onClick:()=>f(void 0,null,function*(){var e;if(a.trim()){h(!0);try{const t=yield mi.analyzeCommand(a);d(t),(null==(e=t.template)?void 0:e.id)&&(yield oi.from("template_usage").insert({template_id:t.template.id,command:a,success:!0}))}catch(t){}finally{h(!1)}}}),disabled:u||!a.trim(),className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Analyzing...":"Analyze Command"})]})]}),c&&we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Analysis Results"}),we.jsxs("div",{className:"space-y-4",children:[we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Content Type"}),we.jsx("p",{className:"text-sm text-gray-600 capitalize",children:c.contentType})]}),we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Suggested Layout"}),we.jsx("p",{className:"text-sm text-gray-600 capitalize",children:c.layout})]}),we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Sections"}),we.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:c.sections.map(e=>we.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:e},e))})]}),c.template&&we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Selected Template"}),we.jsx("p",{className:"text-sm text-gray-600",children:c.template.name})]}),we.jsx("button",{onClick:()=>f(void 0,null,function*(){if(c)try{yield mi.generateTemplateData(a,c)}catch(e){}}),className:"w-full bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700",children:"Generate Template Data"})]})]}),i&&we.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[we.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Template Details"}),we.jsxs("div",{className:"space-y-3",children:[we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Name"}),we.jsx("p",{className:"text-sm text-gray-600",children:i.name})]}),we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Style"}),we.jsx("p",{className:"text-sm text-gray-600",children:i.style})]}),we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Sections"}),we.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:null==(e=i.sections)?void 0:e.map(e=>we.jsx("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-700 rounded",children:e},e))})]}),we.jsxs("div",{children:[we.jsx("h4",{className:"font-medium text-gray-900",children:"Usage Statistics"}),we.jsxs("p",{className:"text-sm text-gray-600",children:["Used ",i.usage_count||0," times"]}),we.jsxs("p",{className:"text-sm text-gray-600",children:["Success rate: ",i.success_rate?`${(100*i.success_rate).toFixed(1)}%`:"0%"]})]})]})]})]})]}),we.jsx("div",{className:"mt-8",children:we.jsxs("div",{className:"bg-white rounded-lg shadow",children:[we.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:we.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Available Layouts"})}),we.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 p-6",children:r.map(e=>we.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[we.jsx("h3",{className:"font-medium text-gray-900",children:e.name}),we.jsx("p",{className:"text-sm text-gray-600 mt-1 capitalize",children:e.content_type}),we.jsx("div",{className:"mt-2",children:we.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${x(e.content_type)}`,children:e.content_type})})]},e.id))})]})})]})})},gi=({onClose:e})=>{const[t,s]=m.useState([]),[r,n]=m.useState(""),[i,o]=m.useState(!1),[a,l]=m.useState(null),c=m.useRef(null),d=m.useRef(null);m.useEffect(()=>{var e;null==(e=c.current)||e.scrollIntoView({behavior:"smooth"})},[t]),m.useEffect(()=>{var e;null==(e=d.current)||e.focus();s([{id:"welcome",type:"ai",content:"Hello! I'm your AI assistant. I can help you with:\n\nðŸŽ¯ Resume & Cover Letter Creation\nðŸ“Š Template Suggestions  \nðŸ”§ General Assistance\nðŸ’¡ Learning & Improvement\n\nWhat would you like help with today?",timestamp:new Date}])},[]);const u=()=>f(void 0,null,function*(){if(!r.trim()||i)return;const e={id:Date.now().toString(),type:"user",content:r,timestamp:new Date};s(t=>[...t,e]),n(""),o(!0);try{const e=yield h(r),t={id:(Date.now()+1).toString(),type:"ai",content:e,timestamp:new Date};s(e=>[...e,t]),yield hi.recordInteraction({command:r,response:e,success:!0,complexity:5})}catch(t){const e={id:(Date.now()+1).toString(),type:"ai",content:"I apologize, but I'm having trouble processing your request right now. Please try again.",timestamp:new Date};s(t=>[...t,e])}finally{o(!1)}}),h=e=>f(void 0,null,function*(){if("resume"!==mi.detectContentType(e)){const t=yield mi.analyzeCommand(e);return p(t)}return/help|assist|support|guide/i.test(e)?g():/learn|improve|better|enhance/i.test(e)?yield y():b(e)}),p=e=>{const{contentType:t,layout:s,sections:r,template:n}=e;return`I'll help you with that! Based on your request:\n\nðŸ“„ Document Type: ${t.charAt(0).toUpperCase()+t.slice(1)}\nðŸŽ¨ Recommended Layout: ${s.charAt(0).toUpperCase()+s.slice(1)}\nðŸ“‹ Sections: ${r.join(", ")}\n\n${n?`Selected Template: ${n.name}`:""}\n\nWould you like me to:\nâ€¢ Generate template data\nâ€¢ Suggest alternative layouts\nâ€¢ Help customize sections\nâ€¢ Show similar templates`},g=()=>'I\'m here to help! Here\'s what I can do:\n\nðŸŽ¯ Document Creation\nâ€¢ Create resumes, cover letters, portfolios, CVs\nâ€¢ Suggest templates and layouts\nâ€¢ Generate content structure\n\nðŸ“Š Template Management\nâ€¢ Analyze your requirements\nâ€¢ Recommend best templates\nâ€¢ Customize layouts\n\nðŸ¤– AI Learning\nâ€¢ Learn from conversations\nâ€¢ Improve responses over time\nâ€¢ Provide personalized suggestions\n\nðŸ’¡ Examples:\nâ€¢ "Create a modern resume for a software developer"\nâ€¢ "What template for a creative portfolio?"\nâ€¢ "Help improve my cover letter"',y=()=>f(void 0,null,function*(){const e=yield hi.getLearningInsights();return`Here's what I've learned:\n\nðŸ“Š Learning Progress:\nâ€¢ Total interactions: ${e.totalInteractions||0}\nâ€¢ Success rate: ${e.successRate?(100*e.successRate).toFixed(1):0}%\nâ€¢ Average complexity: ${e.avgComplexity?e.avgComplexity.toFixed(1):0}/10\n\nðŸŽ¯ Improvement Areas:\nâ€¢ Better understanding of preferences\nâ€¢ More relevant template suggestions\nâ€¢ Personalized responses\n\nðŸ’¡ Tips for Better Results:\nâ€¢ Be specific about your needs\nâ€¢ Mention industry or role\nâ€¢ Include style preferences\nâ€¢ Ask for specific sections`}),b=e=>`I understand you're asking about "${e}". Let me help you with that. Could you provide more specific details about what you'd like to accomplish? I can help with document creation, template suggestions, or general guidance.`;return we.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:we.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl h-[80vh] flex flex-col",children:[we.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[we.jsxs("div",{className:"flex items-center space-x-3",children:[we.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center",children:we.jsx(G,{className:"h-5 w-5 text-white"})}),we.jsxs("div",{children:[we.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"AI Assistant"}),we.jsx("p",{className:"text-sm text-gray-500",children:"Chat with your AI assistant"})]})]}),we.jsx("button",{onClick:e,className:"p-2 text-gray-600 hover:text-red-600 transition-colors",children:"âœ•"})]}),we.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.map(e=>we.jsx("div",{className:"flex "+("user"===e.type?"justify-end":"justify-start"),children:we.jsxs("div",{className:"max-w-[80%] rounded-lg p-4 "+("user"===e.type?"bg-blue-600 text-white":"bg-gray-100 text-gray-900"),children:[we.jsxs("div",{className:"flex items-start space-x-2",children:["ai"===e.type&&we.jsx(G,{className:"h-5 w-5 text-blue-600 mt-1 flex-shrink-0"}),we.jsx("div",{className:"flex-1",children:we.jsx("div",{className:"whitespace-pre-wrap",children:e.content})})]}),we.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-gray-200",children:[we.jsx("span",{className:"text-xs text-gray-500",children:e.timestamp.toLocaleTimeString()}),"ai"===e.type&&we.jsx("button",{onClick:()=>{return t=e.id,s=e.content,f(void 0,null,function*(){try{yield navigator.clipboard.writeText(s),l(t),setTimeout(()=>l(null),2e3)}catch(e){}});var t,s},className:"text-xs text-gray-500 hover:text-blue-600 transition-colors",title:"Copy message",children:a===e.id?we.jsx(Y,{className:"h-3 w-3"}):we.jsx(Q,{className:"h-3 w-3"})})]})]})},e.id)),we.jsx("div",{ref:c})]}),we.jsx("div",{className:"p-4 border-t border-gray-200",children:we.jsxs("div",{className:"flex items-end space-x-2",children:[we.jsx("div",{className:"flex-1",children:we.jsx("textarea",{ref:d,value:r,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},placeholder:"Type your message here... (Press Enter to send)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",rows:1,style:{minHeight:"40px",maxHeight:"120px"}})}),we.jsx("button",{onClick:u,disabled:i||!r.trim(),className:"bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?we.jsx(X,{className:"h-5 w-5 animate-spin"}):we.jsx(Z,{className:"h-5 w-5"})})]})})]})})},yi=()=>{const[e,t]=m.useState(!1),[s,r]=m.useState(!1),[n,i]=m.useState(!1),[o,a]=m.useState(!1),[l,c]=m.useState(!1),[d,u]=m.useState(!1),[h,f]=m.useState(!1),{user:p,profile:g,isAuthenticated:y,logout:b,getUserDisplayName:v,getUserInitials:j}=ci();x();const k=m.useRef(null);m.useEffect(()=>{},[p,g,y]),m.useEffect(()=>{const e=e=>{k.current&&!k.current.contains(e.target)&&f(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const N=({isActive:e})=>"transition-colors hover:text-blue-600 "+(e?"text-blue-600 font-semibold":"text-gray-600 font-medium"),S=()=>{a(!0),f(!1),t(!1)},E=()=>{c(!0),f(!1),t(!1)},O=()=>{u(!0),f(!1),t(!1)};return we.jsxs("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-40",children:[we.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[we.jsxs("div",{className:"flex justify-between items-center h-16",children:[we.jsxs("div",{className:"flex items-center space-x-8",children:[we.jsxs(w,{to:"/",className:"flex items-center space-x-2",children:[we.jsx("img",{className:"h-8 w-auto",src:"/icons/icon-192x192.png",alt:"AI Resume Pro Logo"}),we.jsx("span",{className:"text-xl font-bold text-gray-900",children:"AI Resume Pro"})]}),we.jsxs("nav",{className:"hidden md:flex space-x-6",children:[we.jsx(_,{to:"/",className:N,children:"Home"}),we.jsx(_,{to:"/resume",className:N,children:"Resume Builder"}),we.jsx(_,{to:"/cover-letter",className:N,children:"Cover Letter"})]})]}),we.jsxs("div",{className:"flex items-center space-x-4",children:[we.jsx("button",{onClick:O,className:"p-2 text-gray-600 hover:text-green-600 transition-colors",title:"AI Chat Assistant",children:we.jsx(ee,{className:"h-5 w-5"})}),we.jsx("button",{onClick:E,className:"p-2 text-gray-600 hover:text-orange-600 transition-colors",title:"Template Dashboard",children:we.jsx(te,{className:"h-5 w-5"})}),we.jsx("button",{onClick:S,className:"p-2 text-gray-600 hover:text-purple-600 transition-colors",title:"AI Learning Dashboard",children:we.jsx(B,{className:"h-5 w-5"})}),we.jsx("button",{onClick:()=>r(!0),className:"p-2 text-gray-600 hover:text-blue-600 transition-colors",title:"PWA Settings",children:we.jsx(T,{className:"h-5 w-5"})}),y?we.jsxs("div",{className:"relative",ref:k,children:[we.jsxs("button",{onClick:()=>f(!h),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:[we.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:j()}),we.jsx("span",{className:"hidden sm:block text-gray-700 font-medium",children:v()}),we.jsx(se,{className:"h-4 w-4 text-gray-500 transition-transform "+(h?"rotate-180":"")})]}),h&&we.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-50",ref:k,children:[we.jsxs("button",{onClick:()=>{i(!0),f(!1),t(!1)},className:"w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[we.jsx(P,{className:"h-4 w-4"}),we.jsx("span",{children:"My Profile"})]}),we.jsxs("button",{onClick:O,className:"w-full px-4 py-2 text-left text-green-600 hover:bg-green-50 flex items-center space-x-2",children:[we.jsx(ee,{className:"h-4 w-4"}),we.jsx("span",{children:"AI Chat"})]}),we.jsxs("button",{onClick:E,className:"w-full px-4 py-2 text-left text-orange-600 hover:bg-orange-50 flex items-center space-x-2",children:[we.jsx(te,{className:"h-4 w-4"}),we.jsx("span",{children:"Templates"})]}),we.jsxs("button",{onClick:S,className:"w-full px-4 py-2 text-left text-purple-600 hover:bg-purple-50 flex items-center space-x-2",children:[we.jsx(B,{className:"h-4 w-4"}),we.jsx("span",{children:"AI Learning"})]}),we.jsxs("button",{onClick:()=>{b(),f(!1)},className:"w-full px-4 py-2 text-left text-red-600 hover:bg-red-50 flex items-center space-x-2",children:[we.jsx(z,{className:"h-4 w-4"}),we.jsx("span",{children:"Sign Out"})]})]})]}):we.jsxs(we.Fragment,{children:[we.jsx(w,{to:"/signin",className:"text-gray-300 hover:text-white transition-colors px-3 py-2 rounded-lg hover:bg-gray-700",children:"Sign In"}),we.jsxs(w,{to:"/signup",className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[we.jsx(P,{className:"h-4 w-4"}),we.jsx("span",{children:"Sign Up"})]})]})]}),we.jsx("button",{onClick:()=>t(!e),className:"md:hidden p-2 rounded-md text-gray-700 hover:text-blue-600 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500","aria-expanded":e,children:e?we.jsx(I,{className:"h-6 w-6"}):we.jsx(re,{className:"h-6 w-6"})})]}),we.jsx("div",{className:"md:hidden "+(e?"block":"hidden"),children:we.jsxs("div",{className:"px-2 pt-2 pb-3 space-y-1 bg-white border-t border-gray-200",children:[we.jsx(_,{to:"/",className:({isActive:e})=>"block px-3 py-2 rounded-md text-base font-medium "+(e?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"),onClick:()=>t(!1),children:"Home"}),we.jsx(_,{to:"/resume",className:({isActive:e})=>"block px-3 py-2 rounded-md text-base font-medium "+(e?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"),onClick:()=>t(!1),children:"Resume Builder"}),we.jsx(_,{to:"/cover-letter",className:({isActive:e})=>"block px-3 py-2 rounded-md text-base font-medium "+(e?"text-blue-600 bg-blue-50":"text-gray-700 hover:text-blue-600 hover:bg-gray-50"),onClick:()=>t(!1),children:"Cover Letter"}),y&&we.jsxs(we.Fragment,{children:[we.jsx("button",{onClick:O,className:"w-full text-left px-3 py-2 rounded-md text-base font-medium text-green-600 hover:bg-green-50",children:"AI Chat Assistant"}),we.jsx("button",{onClick:E,className:"w-full text-left px-3 py-2 rounded-md text-base font-medium text-orange-600 hover:bg-orange-50",children:"Template Dashboard"}),we.jsx("button",{onClick:S,className:"w-full text-left px-3 py-2 rounded-md text-base font-medium text-purple-600 hover:bg-purple-50",children:"AI Learning Dashboard"})]})]})})]}),s&&we.jsx(kt,{onClose:()=>r(!1)}),n&&we.jsx(ui,{onClose:()=>i(!1)}),o&&we.jsx(fi,{onClose:()=>a(!1)}),l&&we.jsx(pi,{onClose:()=>c(!1)}),d&&we.jsx(gi,{onClose:()=>u(!1)})]})},bi=()=>we.jsx("footer",{className:"bg-gray-800 text-gray-300 w-full mt-auto",children:we.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[we.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[we.jsxs("div",{className:"md:col-span-2 lg:col-span-1",children:[we.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[we.jsx(ne,{className:"h-8 w-8 text-blue-400"}),we.jsx("span",{className:"text-xl font-bold text-white",children:"AI Resume Pro"})]}),we.jsx("p",{className:"text-gray-400 mb-4 text-sm",children:"Create professional, ATS-friendly resumes and cover letters with the power of AI."})]}),we.jsxs("div",{children:[we.jsx("h3",{className:"text-md font-semibold text-gray-100 mb-4 uppercase tracking-wider",children:"Quick Links"}),we.jsxs("ul",{className:"space-y-2",children:[we.jsx("li",{children:we.jsx(w,{to:"/",className:"text-sm text-gray-400 hover:text-white transition-colors",children:"Home"})}),we.jsx("li",{children:we.jsx(w,{to:"/resume-for-freshers",className:"text-sm text-gray-400 hover:text-white transition-colors",children:"For Freshers"})}),we.jsx("li",{children:we.jsx(w,{to:"/resume-for-gulf-jobs",className:"text-sm text-gray-400 hover:text-white transition-colors",children:"For Gulf Jobs"})}),we.jsx("li",{children:we.jsx(w,{to:"/cover-letter-for-teachers",className:"text-sm text-gray-400 hover:text-white transition-colors",children:"For Teachers"})})]})]}),we.jsxs("div",{children:[we.jsx("h3",{className:"text-md font-semibold text-gray-100 mb-4 uppercase tracking-wider",children:"Features"}),we.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[we.jsx("li",{children:"AI Content Generation"}),we.jsx("li",{children:"Professional Templates"}),we.jsx("li",{children:"Instant PDF Export"}),we.jsx("li",{children:"Fully Responsive Design"}),we.jsx("li",{children:"100% Free Forever"})]})]}),we.jsxs("div",{children:[we.jsx("h3",{className:"text-md font-semibold text-gray-100 mb-4 uppercase tracking-wider",children:"Connect With Us"}),we.jsxs("div",{className:"flex space-x-4",children:[we.jsx("a",{href:"https://github.com/MuhammadMonisSheikh",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white",children:we.jsx(ie,{size:20})}),we.jsx("a",{href:"https://www.linkedin.com/in/muhammad-monis-sheikh-18a881236/",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white",children:we.jsx(oe,{size:20})}),we.jsx("a",{href:"https://x.com/monis_vohra",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white",children:we.jsx(ae,{size:20})}),we.jsx("a",{href:"https://www.facebook.com/muhammadmonissh",target:"_blank",rel:"noopener noreferrer",className:"text-gray-400 hover:text-white",children:we.jsx(le,{size:20})})]})]})]}),we.jsxs("div",{className:"border-t border-gray-700 mt-8 pt-8 flex flex-col sm:flex-row justify-between items-center text-sm",children:[we.jsxs("p",{className:"text-gray-400",children:["Â© ",(new Date).getFullYear()," AI Resume Pro. All Rights Reserved."]}),we.jsx("p",{className:"text-gray-400 mt-2 sm:mt-0",children:"Built with â¤ï¸ for Job Seekers"})]})]})});class vi extends y.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}render(){return this.state.hasError?we.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:we.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[we.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:we.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:we.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),we.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),we.jsx("p",{className:"text-gray-600 mb-4",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),we.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Refresh Page"}),!1]})}):this.props.children||null}}var xi={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},wi=y.createContext&&y.createContext(xi),_i=["attr","size","title"];function ji(e,t){if(null==e)return{};var s,r,n=function(e,t){if(null==e)return{};var s={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;s[r]=e[r]}return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)s=i[r],t.indexOf(s)>=0||Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function ki(){return ki=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r])}return e},ki.apply(this,arguments)}function Ni(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,r)}return s}function Si(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?Ni(Object(s),!0).forEach(function(t){Ti(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):Ni(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function Ti(e,t,s){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function Ei(e){return e&&e.map((e,t)=>y.createElement(e.tag,Si({key:t},e.attr),Ei(e.child)))}function Oi(e){return t=>y.createElement(Ci,ki({attr:Si({},e.attr)},t),Ei(e.child))}function Ci(e){var t=t=>{var s,{attr:r,size:n,title:i}=e,o=ji(e,_i),a=n||t.size||"1em";return t.className&&(s=t.className),e.className&&(s=(s?s+" ":"")+e.className),y.createElement("svg",ki({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,o,{className:s,style:Si(Si({color:e.color||t.color},t.style),e.style),height:a,width:a,xmlns:"http://www.w3.org/2000/svg"}),i&&y.createElement("title",null,i),e.children)};return void 0!==wi?y.createElement(wi.Consumer,null,e=>t(e)):t(xi)}function Ai(e){return Oi({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"},child:[]},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"},child:[]}]})(e)}const Pi=m.memo(e=>{var t=e,{src:s,alt:r,className:n="",fallbackSrc:i="/images/placeholder.png",webpSrc:o,priority:a=!1,sizes:l="100vw"}=t,d=u(t,["src","alt","className","fallbackSrc","webpSrc","priority","sizes"]);const[h,f]=m.useState(a?s:""),[p,g]=m.useState(!1),[y,b]=m.useState(!1),[v,x]=m.useState(a),w=m.useRef(null),_=m.useRef(null);m.useEffect(()=>{if(!a)return"IntersectionObserver"in window?(_.current=new IntersectionObserver(e=>{e.forEach(e=>{var t;e.isIntersecting&&(x(!0),f(s),null==(t=_.current)||t.unobserve(e.target))})},{rootMargin:"50px 0px",threshold:.01}),w.current&&_.current.observe(w.current)):(x(!0),f(s)),()=>{_.current&&_.current.disconnect()};f(s)},[s,a]);return m.useEffect(()=>{if(a&&o){const e=document.createElement("link");e.rel="preload",e.as="image",e.href=o,document.head.appendChild(e)}},[a,o]),we.jsxs("div",{ref:w,className:`relative overflow-hidden ${n}`,style:{backgroundColor:p?"transparent":"#f3f4f6",transition:"opacity 0.3s ease-in-out"},children:[v&&we.jsxs("picture",{children:[o&&we.jsx("source",{srcSet:o,type:"image/webp",sizes:l}),we.jsx("img",c({src:h||i,alt:r,className:"w-full h-full object-cover transition-opacity duration-300 "+(p?"opacity-100":"opacity-0"),onLoad:()=>{g(!0),b(!1)},onError:()=>{h!==i?(f(i),b(!1)):b(!0)},loading:a?"eager":"lazy",decoding:"async"},d))]}),!p&&!y&&we.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),y&&we.jsx("div",{className:"absolute inset-0 bg-gray-100 flex items-center justify-center",children:we.jsx("div",{className:"text-gray-400 text-sm",children:"Image unavailable"})})]})});Pi.displayName="OptimizedImage";const Ii=({error:e,errorInfo:t})=>{const s=j(),[r,n]=m.useState(!1),[i,o]=m.useState(!1),a=(import.meta,"production");if("development"!==a)return null;return we.jsxs(we.Fragment,{children:[we.jsx("button",{onClick:()=>n(e=>!e),style:{position:"fixed",bottom:"1.5rem",left:"1.5rem",zIndex:1e4,background:"#222",color:"#fff",border:"none",borderRadius:"50%",width:48,height:48,boxShadow:"0 2px 8px rgba(0,0,0,0.18)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},title:r?"Hide Dev Panel":"Show Dev Panel",children:we.jsx(Ai,{size:28})}),r&&we.jsxs("div",{style:{position:"fixed",bottom:"5.5rem",left:"1.5rem",backgroundColor:"#111",color:"#fff",padding:"1rem",borderRadius:"0.75rem",fontSize:"14px",maxWidth:"320px",boxShadow:"0 0 10px rgba(0,0,0,0.5)",zIndex:9999},children:[we.jsxs("div",{children:[we.jsx("strong",{children:"Route:"})," ",s.pathname,we.jsx("br",{}),we.jsx("strong",{children:"Env:"})," ",a]}),we.jsx("button",{onClick:()=>o(e=>!e),style:{marginTop:"0.75rem",background:"#444",color:"#fff",border:"none",padding:"0.4rem 0.75rem",borderRadius:"4px",cursor:"pointer"},children:"âš™ï¸ Preferences"}),i&&we.jsxs("div",{style:{marginTop:"0.5rem",background:"#222",padding:"0.75rem",borderRadius:"6px"},children:[we.jsxs("p",{children:["ðŸ” Auto Reload: ",we.jsx("input",{type:"checkbox"})]}),we.jsxs("p",{children:["ðŸ§ª Mock API: ",we.jsx("input",{type:"checkbox"})]})]}),we.jsx("button",{onClick:()=>window.location.reload(),children:"ðŸ”„ Reload"}),e&&we.jsx("button",{onClick:()=>{},children:"ðŸ§¹ Clear Error"}),e&&we.jsxs("div",{style:{marginTop:"1rem",backgroundColor:"#550000",color:"#ffcccc",padding:"0.5rem",borderRadius:"4px",fontSize:"12px",whiteSpace:"pre-wrap",overflowY:"auto",maxHeight:"180px"},children:[we.jsx("strong",{children:"ðŸ”¥ Error:"}),we.jsx("p",{children:e.toString()}),we.jsx("p",{children:null==t?void 0:t.componentStack})]}),we.jsx(Pi,{src:"/images/templates/classic.png",alt:"Classic Template",width:400,height:300})]})]})},$i=()=>{const[e,t]=m.useState(navigator.onLine),[s,r]=m.useState(!1);return m.useEffect(()=>{const e=()=>{t(!0),r(!0),setTimeout(()=>r(!1),3e3)},s=()=>{t(!1),r(!0)};return window.addEventListener("online",e),window.addEventListener("offline",s),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",s)}},[]),s?we.jsx("div",{className:"fixed top-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50",children:we.jsxs("div",{className:"rounded-lg shadow-lg border p-4 flex items-center space-x-3 "+(e?"bg-green-50 border-green-200 text-green-800":"bg-red-50 border-red-200 text-red-800"),children:[e?we.jsx(K,{className:"h-5 w-5 text-green-600"}):we.jsx(ce,{className:"h-5 w-5 text-red-600"}),we.jsxs("div",{className:"flex-1",children:[we.jsx("p",{className:"font-medium",children:e?"Back Online":"You're Offline"}),we.jsx("p",{className:"text-sm opacity-80",children:e?"Your connection has been restored":"Some features may be limited while offline"})]}),we.jsx("button",{onClick:()=>r(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:"Ã—"})]})}):null},Ri=()=>{const[e,t]=m.useState(!1),[s,r]=m.useState(!1),[n,i]=m.useState(null);m.useEffect(()=>{const e=e=>{e.preventDefault(),i(e),t(!0)};return window.addEventListener("beforeinstallprompt",e),()=>{window.removeEventListener("beforeinstallprompt",e)}},[]);const o=()=>{r(!0)};return!e||s?null:we.jsx("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:w-80 z-50 animate-fade-in-up",children:we.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border border-gray-200 p-4",children:[we.jsxs("div",{className:"flex items-start justify-between mb-3",children:[we.jsxs("div",{className:"flex items-center space-x-3",children:[we.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:we.jsx(de,{className:"h-5 w-5 text-blue-600"})}),we.jsxs("div",{children:[we.jsx("h3",{className:"font-semibold text-gray-900",children:"Install AI Resume Pro"}),we.jsx("p",{className:"text-sm text-gray-600",children:"Get a faster, offline experience."})]})]}),we.jsx("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 transition-colors",children:we.jsx(I,{className:"h-4 w-4"})})]}),we.jsxs("div",{className:"space-y-3",children:[we.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[we.jsx(A,{className:"h-4 w-4 text-green-500"}),we.jsx("span",{children:"Works offline on mobile & desktop"})]}),we.jsxs("div",{className:"flex space-x-2 pt-2",children:[we.jsx("button",{onClick:()=>f(void 0,null,function*(){if(n){n.prompt();const{outcome:e}=yield n.userChoice;"accepted"===e&&(i(null),t(!1))}}),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Install App"}),we.jsx("button",{onClick:o,className:"px-4 py-2 text-gray-600 text-sm font-medium hover:bg-gray-100 rounded-lg transition-colors",children:"Not Now"})]})]})]})})},Li=m.memo(({adSlot:e,adFormat:t="auto",adClient:s="ca-pub-YOUR_PUBLISHER_ID",lazyLoad:r=!0,delay:n=2e3})=>{const i=m.useRef(null),o=m.useRef(!1),[a,l]=m.useState(!r),[c,d]=m.useState(!1);return m.useEffect(()=>{if(r){const e=setTimeout(()=>{l(!0)},n);return()=>clearTimeout(e)}},[r,n]),m.useEffect(()=>{if(!a||!i.current)return;const e=new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting&&(d(!0),e.unobserve(t.target))})},{rootMargin:"100px 0px",threshold:.1});return e.observe(i.current),()=>{e.disconnect()}},[a]),m.useEffect(()=>{if(c&&!o.current&&window.adsbygoogle&&i.current)try{i.current.hasAttribute("data-ad-status")||((window.adsbygoogle=window.adsbygoogle||[]).push({}),o.current=!0)}catch(e){}},[c]),a?we.jsxs("div",{ref:i,className:"ad-container my-4 text-center bg-gray-100 p-4 rounded-lg",children:[c&&we.jsx("ins",{className:"adsbygoogle",style:{display:"block"},"data-ad-client":s,"data-ad-slot":e,"data-ad-format":t,"data-full-width-responsive":"true"}),we.jsx("small",{className:"text-gray-400",children:"Advertisement"})]}):we.jsx("div",{className:"ad-container my-4 text-center bg-gray-50 p-4 rounded-lg",children:we.jsxs("div",{className:"animate-pulse",children:[we.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3 mx-auto mb-2"}),we.jsx("div",{className:"h-32 bg-gray-200 rounded"})]})})});Li.displayName="AdPlaceholder";const Di=m.memo(()=>{const[e,t]=m.useState({loadTime:0,domContentLoaded:0,firstPaint:0,firstContentfulPaint:0,isOnline:navigator.onLine,memory:null}),[s,r]=m.useState(!1);return m.useEffect(()=>{},[]),null});Di.displayName="PerformanceMonitor";const Ui=m.lazy(()=>Ne(()=>import("./Home-DXQ5n2Xp.js"),__vite__mapDeps([0,1,2,3,4,5,6]))),Mi=m.lazy(()=>Ne(()=>import("./ResumeForFreshers-CvEcBkLu.js"),__vite__mapDeps([7,1,2,3,4,5]))),zi=m.lazy(()=>Ne(()=>import("./ResumeForGulfJobs-Cp4D9i1q.js"),__vite__mapDeps([8,1,3,4,5]))),Bi=m.lazy(()=>Ne(()=>import("./CoverLetterForTeachers-DOexCrws.js"),__vite__mapDeps([9,1,3,4,5]))),qi=m.lazy(()=>Ne(()=>import("./SignIn-CNdVNshW.js"),__vite__mapDeps([10,1,5,4]))),Fi=m.lazy(()=>Ne(()=>import("./SignUp-C5Udgs6L.js"),__vite__mapDeps([11,1,5,4]))),Hi=m.lazy(()=>Ne(()=>import("./ForgotPassword-DLI535bp.js"),__vite__mapDeps([12,1,5,4]))),Ji=m.memo(()=>we.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:we.jsxs("div",{className:"text-center",children:[we.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),we.jsx("p",{className:"text-gray-600",children:"Loading..."})]})}));Ji.displayName="LoadingSkeleton";const Wi=m.memo(()=>{let e;y.useEffect(()=>{document.addEventListener("mouseover",()=>Ne(()=>import("./Home-DXQ5n2Xp.js"),__vite__mapDeps([0,1,2,3,4,5,6])),{once:!0}),document.addEventListener("mouseover",()=>Ne(()=>import("./ResumeForFreshers-CvEcBkLu.js"),__vite__mapDeps([7,1,2,3,4,5])),{once:!0})},[]),window.addEventListener("beforeinstallprompt",t=>{t.preventDefault(),e=t});const t=document.getElementById("install-button");return t&&t.addEventListener("click",()=>{e&&(e.prompt(),e=null)}),we.jsx(pt,{children:we.jsx(di,{children:we.jsxs(k,{children:[we.jsxs("div",{className:"flex flex-col min-h-screen",children:[we.jsx(vi,{children:we.jsx(yi,{})}),we.jsx("main",{className:"flex-grow",children:we.jsx(m.Suspense,{fallback:we.jsx(Ji,{}),children:we.jsxs(N,{children:[we.jsx(S,{path:"/",element:we.jsx(Ui,{})}),we.jsx(S,{path:"/resume-for-freshers",element:we.jsx(Mi,{})}),we.jsx(S,{path:"/resume-for-gulf-jobs",element:we.jsx(zi,{})}),we.jsx(S,{path:"/cover-letter-for-teachers",element:we.jsx(Bi,{})}),we.jsx(S,{path:"/signin",element:we.jsx(qi,{})}),we.jsx(S,{path:"/signup",element:we.jsx(Fi,{})}),we.jsx(S,{path:"/forgot-password",element:we.jsx(Hi,{})})]})})}),we.jsx(vi,{children:we.jsx(bi,{})})]}),we.jsx(ue,{position:"top-right",autoClose:3e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),we.jsx(Ri,{}),we.jsx($i,{}),we.jsx(Ii,{}),we.jsx(Di,{})]})})})}),Ki=_e.createRoot(document.getElementById("root"));try{Ki.render(we.jsx(y.StrictMode,{children:we.jsx(Wi,{})}))}catch(Vi){Ki.render(we.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:we.jsxs("div",{className:"text-center",children:[we.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Something went wrong"}),we.jsx("p",{className:"text-gray-600 mb-4",children:"Please refresh the page or try again later."}),we.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700",children:"Refresh Page"})]})}))}export{Li as A,_t as H,Ne as _,ci as a,we as j,jt as u};
